<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title><![CDATA[琴心剑胆]]></title>
  <subtitle><![CDATA[Life is painting a picture, not doing a sum.]]></subtitle>
  <link href="/atom.xml" rel="self"/>
  <link href="http://falconchen.github.io/"/>
  <updated>2014-08-26T09:11:58.662Z</updated>
  <id>http://falconchen.github.io/</id>
  
  <author>
    <name><![CDATA[Falcon Chen]]></name>
    <email><![CDATA[falcon_chen@qq.com]]></email>
  </author>
  
  <generator uri="http://zespia.tw/hexo/">Hexo</generator>
  
  <entry>
    <title><![CDATA[linux 设置日期]]></title>
    <link href="http://falconchen.github.io/2014/08/26/linux-date-setting/"/>
    <id>http://falconchen.github.io/2014/08/26/linux-date-setting/</id>
    <published>2014-08-26T09:09:57.000Z</published>
    <updated>2014-08-26T09:10:30.000Z</updated>
    <content type="html"><![CDATA[<h3 id="linux_设置日期">linux 设置日期</h3>
<p>linux系统下查看和设置日期时间的命令都是date。</p>
<p>查看日期时间命令：<code>date</code></p>
<p>设置日期时间命令：<code>date -s [date|time]</code></p>
<p>设置系统日期为2008年9月9日</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre><span class="built_in">date</span> <span class="attribute">-s</span> <span class="number">20080909</span>
</pre></td></tr></table></figure>


<p>设置系统时间为14:25:49</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre><span class="tag">date</span> <span class="tag">-s</span> 14<span class="pseudo">:25</span><span class="pseudo">:49</span>
</pre></td></tr></table></figure>


<p>设置系统日期和时间为:2008年9月9日14时25分49秒</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre><span class="built_in">date</span> <span class="attribute">-s</span> <span class="string">'20080909 14:25:49'</span>   <span class="comment">//一定要加引号才行。</span>
</pre></td></tr></table></figure>

<p>其实设置的日期和时间格式是灵活的，可以有很多格式。</p>
]]></content>
    
    
      <category term="Linux" scheme="http://falconchen.github.io/tags/Linux/"/>
    
      <category term="日期" scheme="http://falconchen.github.io/tags/%E6%97%A5%E6%9C%9F/"/>
    
      <category term="Linux" scheme="http://falconchen.github.io/categories/Linux/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[jqmobi和phonegap]]></title>
    <link href="http://falconchen.github.io/2014/08/07/jqmobi-phonegap/"/>
    <id>http://falconchen.github.io/2014/08/07/jqmobi-phonegap/</id>
    <published>2014-08-07T05:55:30.000Z</published>
    <updated>2014-08-07T06:01:06.000Z</updated>
    <content type="html"><![CDATA[<h3 id="jqMobi资源">jqMobi资源</h3>
<ul>
<li><p>入门视频<br><a href="http://bbs.phonegap100.com/thread-361-1-1.html" target="_blank">http://bbs.phonegap100.com/thread-361-1-1.html</a></p>
</li>
<li><p>官网文档: 快速入门<br><a href="http://app-framework-software.intel.com/documentation.php#intro/quickstart" target="_blank">http://app-framework-software.intel.com/documentation.php#intro/quickstart</a></p>
</li>
<li><p>github的源码 appframework2.1<br><a href="https://github.com/01org/appframework/tree/2.1devtf" target="_blank">https://github.com/01org/appframework/tree/2.1devtf</a></p>
</li>
<li><p>appframework与html5, web app开发<br><a href="http://blog.csdn.net/dawanganban/article/details/17591373" target="_blank">http://blog.csdn.net/dawanganban/article/details/17591373</a></p>
</li>
</ul>
<h3 id="phoneGap资源">phoneGap资源</h3>
<ul>
<li><p>安装 2.9与3.4<br><a href="http://www.phonegap100.com/article-101-1.html" target="_blank">http://www.phonegap100.com/article-101-1.html</a></p>
</li>
<li><p>案例<br><a href="http://www.phonegap100.com/article-226-1.html" target="_blank">http://www.phonegap100.com/article-226-1.html</a></p>
</li>
<li><p>PhoneGap应用开发对策：如何通过苹果审核？<br><a href="http://www.phonegap100.com/article-229-1.html" target="_blank">http://www.phonegap100.com/article-229-1.html</a></p>
</li>
<li><p>phonegap实战视频教程赞助下载<br><a href="http://bbs.phonegap100.com/thread-296-1-1.html" target="_blank">http://bbs.phonegap100.com/thread-296-1-1.html</a></p>
</li>
</ul>
<h3 id="Android">Android</h3>
<ul>
<li>安装ADT<br><a href="http://developer.android.com/sdk/installing/installing-adt.html" target="_blank">http://developer.android.com/sdk/installing/installing-adt.html</a></li>
</ul>
]]></content>
    
    
      <category term="jqmobi" scheme="http://falconchen.github.io/tags/jqmobi/"/>
    
      <category term="手机" scheme="http://falconchen.github.io/tags/%E6%89%8B%E6%9C%BA/"/>
    
      <category term="phonegap" scheme="http://falconchen.github.io/tags/phonegap/"/>
    
      <category term="移动开发" scheme="http://falconchen.github.io/categories/%E7%A7%BB%E5%8A%A8%E5%BC%80%E5%8F%91/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[laravel 笔记]]></title>
    <link href="http://falconchen.github.io/2014/07/21/laravel-study/"/>
    <id>http://falconchen.github.io/2014/07/21/laravel-study/</id>
    <published>2014-07-21T02:22:45.000Z</published>
    <updated>2014-08-07T05:52:59.000Z</updated>
    <content type="html"><![CDATA[<h3 id="安装composer">安装composer</h3>
<p><a href="https://getcomposer.org/doc/00-intro.md" target="_blank">https://getcomposer.org/doc/00-intro.md</a></p>
<p>在<code>windows</code>下可直接使用 <a href="https://getcomposer.org/Composer-Setup.exe" target="_blank">Windows installer</a>安装</p>
<h3 id="安装laravel">安装laravel</h3>
<p>下载 <a href="http://laravel.com/laravel.phar" target="_blank">Laravel installer PHAR archive</a></p>
<p>windows下可新建一个laravel文件夹，将laravel.phar放入该目录，在目录新建一个文件laravel.bat，写入以下内容:</p>
<pre><code><span class="variable">@php</span> <span class="string">"%~dp0laravel.phar"</span> <span class="variable">%*</span>
</code></pre><p>最后将该目录放入系统环境变量%path%即可。</p>
<p>运行<br><img src="http://i.imgur.com/AuhcXWX.jpg" alt="运行lavaral"></p>
<p>创建项目</p>
<pre><code>laravel <span class="keyword">new</span> weblog
</code></pre><p>等待一段时间后会在当前目录新建一个weblog的文件夹，目录结构如下：</p>
<p>├─app<br>│  ├─commands<br>│  ├─config<br>│  │  ├─local<br>│  │  ├─packages<br>│  │  └─testing<br>│  ├─controllers<br>│  ├─database<br>│  │  ├─migrations<br>│  │  └─seeds<br>│  ├─lang<br>│  │  └─en<br>│  ├─models<br>│  ├─start<br>│  ├─storage<br>│  │  ├─cache<br>│  │  ├─logs<br>│  │  ├─meta<br>│  │  ├─sessions<br>│  │  └─views<br>│  ├─tests<br>│  └─views<br>│      └─emails<br>│          └─auth<br>├─bootstrap<br>├─public<br>│  └─packages<br>└─vendor<br>    ├─bin<br>    ├─classpreloader<br>    │  └─classpreloader<br>    │      └─src<br>    │          └─ClassPreloader<br>    │              ├─Command<br>    │              └─Parser<br>    ├─composer<br>    ├─d11wtq<br>    │  └─boris<br>    │      ├─bin<br>    │      └─lib<br>    │          └─Boris<br>    ├─filp<br>    │  └─whoops<br>    │      ├─docs<br>    │      ├─examples<br>    │      ├─src<br>    │      │  ├─deprecated<br>    │      │  │  └─Zend<br>    │      │  └─Whoops<br>    │      │      ├─Exception<br>    │      │      ├─Handler<br>    │      │      ├─Provider<br>    │      │      │  ├─Phalcon<br>    │      │      │  └─Silex<br>    │      │      ├─Resources<br>    │      │      │  ├─css<br>    │      │      │  ├─js<br>    │      │      │  └─views<br>    │      │      └─Util<br>    │      └─tests<br>    │          ├─deprecated<br>    │          │  └─Zend<br>    │          ├─fixtures<br>    │          └─Whoops<br>    │              ├─Exception<br>    │              ├─Handler<br>    │              └─Util<br>    ├─ircmaxell<br>    │  └─password-compat<br>    │      ├─lib<br>    │      └─test<br>    │          └─Unit<br>    ├─jeremeamia<br>    │  └─SuperClosure<br>    │      ├─demo<br>    │      ├─src<br>    │      │  └─Jeremeamia<br>    │      │      └─SuperClosure<br>    │      │          └─Visitor<br>    │      └─tests<br>    │          └─Jeremeamia<br>    │              └─SuperClosure<br>    │                  └─Test<br>    │                      └─Visitor<br>    ├─laravel<br>    │  └─framework<br>    │      └─src<br>    │          └─Illuminate<br>    │              ├─Auth<br>    │              │  ├─Console<br>    │              │  │  └─stubs<br>    │              │  └─Reminders<br>    │              ├─Cache<br>    │              │  └─Console<br>    │              ├─Config<br>    │              ├─Console<br>    │              ├─Container<br>    │              ├─Cookie<br>    │              ├─Database<br>    │              │  ├─Capsule<br>    │              │  ├─Connectors<br>    │              │  ├─Console<br>    │              │  │  └─Migrations<br>    │              │  ├─Eloquent<br>    │              │  │  └─Relations<br>    │              │  ├─Migrations<br>    │              │  │  └─stubs<br>    │              │  ├─Query<br>    │              │  │  ├─Grammars<br>    │              │  │  └─Processors<br>    │              │  └─Schema<br>    │              │      └─Grammars<br>    │              ├─Encryption<br>    │              ├─Events<br>    │              ├─Exception<br>    │              │  └─resources<br>    │              ├─Filesystem<br>    │              ├─Foundation<br>    │              │  ├─Console<br>    │              │  │  ├─Optimize<br>    │              │  │  └─stubs<br>    │              │  ├─Providers<br>    │              │  └─Testing<br>    │              ├─Hashing<br>    │              ├─Html<br>    │              ├─Http<br>    │              ├─Log<br>    │              ├─Mail<br>    │              │  └─Transport<br>    │              ├─Pagination<br>    │              │  └─views<br>    │              ├─Queue<br>    │              │  ├─Capsule<br>    │              │  ├─Connectors<br>    │              │  ├─Console<br>    │              │  │  └─stubs<br>    │              │  ├─Failed<br>    │              │  └─Jobs<br>    │              ├─Redis<br>    │              ├─Remote<br>    │              ├─Routing<br>    │              │  ├─Console<br>    │              │  ├─Generators<br>    │              │  │  └─stubs<br>    │              │  └─Matching<br>    │              ├─Session<br>    │              │  └─Console<br>    │              │      └─stubs<br>    │              ├─Support<br>    │              │  ├─Contracts<br>    │              │  ├─Facades<br>    │              │  └─Traits<br>    │              ├─Translation<br>    │              ├─Validation<br>    │              ├─View<br>    │              │  ├─Compilers<br>    │              │  └─Engines<br>    │              └─Workbench<br>    │                  ├─Console<br>    │                  └─stubs<br>    ├─monolog<br>    │  └─monolog<br>    │      ├─doc<br>    │      ├─src<br>    │      │  └─Monolog<br>    │      │      ├─Formatter<br>    │      │      ├─Handler<br>    │      │      │  ├─FingersCrossed<br>    │      │      │  └─SyslogUdp<br>    │      │      └─Processor<br>    │      └─tests<br>    │          └─Monolog<br>    │              ├─Formatter<br>    │              ├─Functional<br>    │              │  └─Handler<br>    │              ├─Handler<br>    │              │  └─Fixtures<br>    │              └─Processor<br>    ├─nesbot<br>    │  └─carbon<br>    │      ├─src<br>    │      │  └─Carbon<br>    │      └─tests<br>    ├─nikic<br>    │  └─php-parser<br>    │      ├─doc<br>    │      │  └─component<br>    │      ├─grammar<br>    │      ├─lib<br>    │      │  └─PHPParser<br>    │      │      ├─Builder<br>    │      │      ├─Comment<br>    │      │      ├─Lexer<br>    │      │      ├─Node<br>    │      │      │  ├─Expr<br>    │      │      │  │  └─Cast<br>    │      │      │  ├─Name<br>    │      │      │  ├─Scalar<br>    │      │      │  └─Stmt<br>    │      │      │      └─TraitUseAdaptation<br>    │      │      ├─NodeVisitor<br>    │      │      ├─PrettyPrinter<br>    │      │      ├─Serializer<br>    │      │      └─Unserializer<br>    │      ├─test<br>    │      │  ├─code<br>    │      │  │  ├─parser<br>    │      │  │  │  ├─expr<br>    │      │  │  │  │  └─fetchAndCall<br>    │      │  │  │  ├─scalar<br>    │      │  │  │  └─stmt<br>    │      │  │  │      ├─class<br>    │      │  │  │      ├─function<br>    │      │  │  │      ├─loop<br>    │      │  │  │      └─namespace<br>    │      │  │  └─prettyPrinter<br>    │      │  └─PHPParser<br>    │      │      └─Tests<br>    │      │          ├─Builder<br>    │      │          ├─Lexer<br>    │      │          ├─Node<br>    │      │          │  ├─Scalar<br>    │      │          │  └─Stmt<br>    │      │          ├─NodeVisitor<br>    │      │          ├─Serializer<br>    │      │          └─Unserializer<br>    │      └─test_old<br>    ├─patchwork<br>    │  └─utf8<br>    │      └─class<br>    │          └─Patchwork<br>    │              ├─PHP<br>    │              │  └─Shim<br>    │              │      ├─charset<br>    │              │      └─unidata<br>    │              └─Utf8<br>    │                  ├─Bootup<br>    │                  └─data<br>    ├─phpseclib<br>    │  └─phpseclib<br>    │      ├─build<br>    │      ├─phpseclib<br>    │      │  ├─Crypt<br>    │      │  ├─File<br>    │      │  ├─Math<br>    │      │  ├─Net<br>    │      │  │  └─SFTP<br>    │      │  └─System<br>    │      │      └─SSH<br>    │      ├─tests<br>    │      │  ├─Functional<br>    │      │  │  └─Net<br>    │      │  └─Unit<br>    │      │      ├─Crypt<br>    │      │      │  ├─AES<br>    │      │      │  ├─Hash<br>    │      │      │  └─RSA<br>    │      │      ├─File<br>    │      │      │  ├─ASN1<br>    │      │      │  └─X509<br>    │      │      ├─Math<br>    │      │      │  └─BigInteger<br>    │      │      └─Net<br>    │      └─travis<br>    ├─predis<br>    │  └─predis<br>    │      ├─bin<br>    │      ├─examples<br>    │      ├─lib<br>    │      │  └─Predis<br>    │      │      ├─Cluster<br>    │      │      │  ├─Distribution<br>    │      │      │  └─Hash<br>    │      │      ├─Collection<br>    │      │      │  └─Iterator<br>    │      │      ├─Command<br>    │      │      │  └─Processor<br>    │      │      ├─Connection<br>    │      │      ├─Iterator<br>    │      │      ├─Monitor<br>    │      │      ├─Option<br>    │      │      ├─Pipeline<br>    │      │      ├─Profile<br>    │      │      ├─Protocol<br>    │      │      │  └─Text<br>    │      │      ├─PubSub<br>    │      │      ├─Replication<br>    │      │      ├─Session<br>    │      │      └─Transaction<br>    │      └─tests<br>    │          ├─PHPUnit<br>    │          └─Predis<br>    │              ├─Cluster<br>    │              │  └─Distribution<br>    │              ├─Collection<br>    │              │  └─Iterator<br>    │              ├─Command<br>    │              │  └─Processor<br>    │              ├─Connection<br>    │              ├─Iterator<br>    │              ├─Monitor<br>    │              ├─Option<br>    │              ├─Pipeline<br>    │              ├─Profile<br>    │              ├─Protocol<br>    │              │  └─Text<br>    │              ├─PubSub<br>    │              ├─Replication<br>    │              └─Transaction<br>    ├─psr<br>    │  └─log<br>    │      └─Psr<br>    │          └─Log<br>    │              └─Test<br>    ├─stack<br>    │  └─builder<br>    │      ├─src<br>    │      │  └─Stack<br>    │      └─tests<br>    │          ├─functional<br>    │          └─unit<br>    │              └─Stack<br>    ├─swiftmailer<br>    │  └─swiftmailer<br>    │      ├─doc<br>    │      │  └─uml<br>    │      ├─lib<br>    │      │  ├─classes<br>    │      │  │  └─Swift<br>    │      │  │      ├─ByteStream<br>    │      │  │      ├─CharacterReader<br>    │      │  │      ├─CharacterReaderFactory<br>    │      │  │      ├─CharacterStream<br>    │      │  │      ├─Encoder<br>    │      │  │      ├─Events<br>    │      │  │      ├─KeyCache<br>    │      │  │      ├─Mailer<br>    │      │  │      ├─Mime<br>    │      │  │      │  ├─ContentEncoder<br>    │      │  │      │  ├─HeaderEncoder<br>    │      │  │      │  └─Headers<br>    │      │  │      ├─Plugins<br>    │      │  │      │  ├─Decorator<br>    │      │  │      │  ├─Loggers<br>    │      │  │      │  ├─Pop<br>    │      │  │      │  └─Reporters<br>    │      │  │      ├─Signers<br>    │      │  │      ├─StreamFilters<br>    │      │  │      └─Transport<br>    │      │  │          └─Esmtp<br>    │      │  │              └─Auth<br>    │      │  └─dependency_maps<br>    │      ├─notes<br>    │      │  └─rfc<br>    │      └─tests<br>    │          ├─acceptance<br>    │          │  └─Swift<br>    │          │      ├─ByteStream<br>    │          │      ├─CharacterReaderFactory<br>    │          │      ├─Encoder<br>    │          │      ├─KeyCache<br>    │          │      ├─Mime<br>    │          │      │  ├─ContentEncoder<br>    │          │      │  └─HeaderEncoder<br>    │          │      └─Transport<br>    │          │          └─StreamBuffer<br>    │          ├─bug<br>    │          │  └─Swift<br>    │          ├─fixtures<br>    │          ├─smoke<br>    │          │  └─Swift<br>    │          │      └─Smoke<br>    │          ├─unit<br>    │          │  └─Swift<br>    │          │      ├─ByteStream<br>    │          │      ├─CharacterReader<br>    │          │      ├─CharacterStream<br>    │          │      ├─Encoder<br>    │          │      ├─Events<br>    │          │      ├─KeyCache<br>    │          │      ├─Mailer<br>    │          │      ├─Mime<br>    │          │      │  ├─ContentEncoder<br>    │          │      │  ├─HeaderEncoder<br>    │          │      │  └─Headers<br>    │          │      ├─Plugins<br>    │          │      │  ├─Loggers<br>    │          │      │  └─Reporters<br>    │          │      ├─Signers<br>    │          │      ├─StreamFilters<br>    │          │      └─Transport<br>    │          │          ├─Esmtp<br>    │          │          │  └─Auth<br>    │          │          └─EsmtpTransport<br>    │          └─_samples<br>    │              ├─charsets<br>    │              │  ├─iso-2022-jp<br>    │              │  ├─iso-8859-1<br>    │              │  └─utf-8<br>    │              ├─dkim<br>    │              ├─files<br>    │              └─smime<br>    └─symfony<br>        ├─browser-kit<br>        │  └─Symfony<br>        │      └─Component<br>        │          └─BrowserKit<br>        │              └─Tests<br>        ├─console<br>        │  └─Symfony<br>        │      └─Component<br>        │          └─Console<br>        │              ├─Command<br>        │              ├─Descriptor<br>        │              ├─Event<br>        │              ├─Formatter<br>        │              ├─Helper<br>        │              ├─Input<br>        │              ├─Logger<br>        │              ├─Output<br>        │              ├─Question<br>        │              ├─Resources<br>        │              │  └─bin<br>        │              ├─Tester<br>        │              └─Tests<br>        │                  ├─Command<br>        │                  ├─Descriptor<br>        │                  ├─Fixtures<br>        │                  ├─Formatter<br>        │                  ├─Helper<br>        │                  ├─Input<br>        │                  ├─Logger<br>        │                  ├─Output<br>        │                  └─Tester<br>        ├─css-selector<br>        │  └─Symfony<br>        │      └─Component<br>        │          └─CssSelector<br>        │              ├─Exception<br>        │              ├─Node<br>        │              ├─Parser<br>        │              │  ├─Handler<br>        │              │  ├─Shortcut<br>        │              │  └─Tokenizer<br>        │              ├─Tests<br>        │              │  ├─Node<br>        │              │  ├─Parser<br>        │              │  │  ├─Handler<br>        │              │  │  └─Shortcut<br>        │              │  └─XPath<br>        │              │      └─Fixtures<br>        │              └─XPath<br>        │                  └─Extension<br>        ├─debug<br>        │  └─Symfony<br>        │      └─Component<br>        │          └─Debug<br>        │              ├─Exception<br>        │              ├─FatalErrorHandler<br>        │              └─Tests<br>        │                  ├─Exception<br>        │                  ├─FatalErrorHandler<br>        │                  └─Fixtures<br>        │                      └─psr4<br>        ├─dom-crawler<br>        │  └─Symfony<br>        │      └─Component<br>        │          └─DomCrawler<br>        │              ├─Field<br>        │              └─Tests<br>        │                  ├─Field<br>        │                  └─Fixtures<br>        ├─event-dispatcher<br>        │  └─Symfony<br>        │      └─Component<br>        │          └─EventDispatcher<br>        │              ├─Debug<br>        │              ├─DependencyInjection<br>        │              └─Tests<br>        │                  ├─Debug<br>        │                  └─DependencyInjection<br>        ├─filesystem<br>        │  └─Symfony<br>        │      └─Component<br>        │          └─Filesystem<br>        │              ├─Exception<br>        │              └─Tests<br>        ├─finder<br>        │  └─Symfony<br>        │      └─Component<br>        │          └─Finder<br>        │              ├─Adapter<br>        │              ├─Comparator<br>        │              ├─Exception<br>        │              ├─Expression<br>        │              ├─Iterator<br>        │              ├─Shell<br>        │              └─Tests<br>        │                  ├─Comparator<br>        │                  ├─Expression<br>        │                  ├─FakeAdapter<br>        │                  ├─Fixtures<br>        │                  │  ├─A<br>        │                  │  │  └─B<br>        │                  │  │      └─C<br>        │                  │  ├─copy<br>        │                  │  │  └─A<br>        │                  │  │      └─B<br>        │                  │  │          └─C<br>        │                  │  ├─one<br>        │                  │  │  └─b<br>        │                  │  └─with space<br>        │                  └─Iterator<br>        ├─http-foundation<br>        │  └─Symfony<br>        │      └─Component<br>        │          └─HttpFoundation<br>        │              ├─File<br>        │              │  ├─Exception<br>        │              │  └─MimeType<br>        │              ├─Resources<br>        │              │  └─stubs<br>        │              ├─Session<br>        │              │  ├─Attribute<br>        │              │  ├─Flash<br>        │              │  └─Storage<br>        │              │      ├─Handler<br>        │              │      └─Proxy<br>        │              └─Tests<br>        │                  ├─File<br>        │                  │  ├─Fixtures<br>        │                  │  │  └─directory<br>        │                  │  └─MimeType<br>        │                  └─Session<br>        │                      ├─Attribute<br>        │                      ├─Flash<br>        │                      └─Storage<br>        │                          ├─Handler<br>        │                          └─Proxy<br>        ├─http-kernel<br>        │  └─Symfony<br>        │      └─Component<br>        │          └─HttpKernel<br>        │              ├─Bundle<br>        │              ├─CacheClearer<br>        │              ├─CacheWarmer<br>        │              ├─Config<br>        │              ├─Controller<br>        │              ├─DataCollector<br>        │              │  └─Util<br>        │              ├─Debug<br>        │              ├─DependencyInjection<br>        │              ├─Event<br>        │              ├─EventListener<br>        │              ├─Exception<br>        │              ├─Fragment<br>        │              ├─HttpCache<br>        │              ├─Log<br>        │              ├─Profiler<br>        │              └─Tests<br>        │                  ├─Bundle<br>        │                  ├─CacheClearer<br>        │                  ├─CacheWarmer<br>        │                  ├─Config<br>        │                  ├─Controller<br>        │                  ├─DataCollector<br>        │                  ├─Debug<br>        │                  ├─DependencyInjection<br>        │                  ├─EventListener<br>        │                  ├─Fixtures<br>        │                  │  ├─BaseBundle<br>        │                  │  │  └─Resources<br>        │                  │  ├─Bundle1Bundle<br>        │                  │  │  └─Resources<br>        │                  │  ├─Bundle2Bundle<br>        │                  │  ├─ChildBundle<br>        │                  │  │  └─Resources<br>        │                  │  ├─ExtensionAbsentBundle<br>        │                  │  ├─ExtensionLoadedBundle<br>        │                  │  │  └─DependencyInjection<br>        │                  │  ├─ExtensionPresentBundle<br>        │                  │  │  ├─Command<br>        │                  │  │  └─DependencyInjection<br>        │                  │  └─Resources<br>        │                  │      ├─BaseBundle<br>        │                  │      ├─Bundle1Bundle<br>        │                  │      ├─ChildBundle<br>        │                  │      └─FooBundle<br>        │                  ├─Fragment<br>        │                  ├─HttpCache<br>        │                  └─Profiler<br>        │                      └─Mock<br>        ├─process<br>        │  └─Symfony<br>        │      └─Component<br>        │          └─Process<br>        │              ├─Exception<br>        │              └─Tests<br>        ├─routing<br>        │  └─Symfony<br>        │      └─Component<br>        │          └─Routing<br>        │              ├─Annotation<br>        │              ├─Exception<br>        │              ├─Generator<br>        │              │  └─Dumper<br>        │              ├─Loader<br>        │              │  └─schema<br>        │              │      └─routing<br>        │              ├─Matcher<br>        │              │  └─Dumper<br>        │              └─Tests<br>        │                  ├─Annotation<br>        │                  ├─Fixtures<br>        │                  │  ├─AnnotatedClasses<br>        │                  │  └─dumper<br>        │                  ├─Generator<br>        │                  │  └─Dumper<br>        │                  ├─Loader<br>        │                  └─Matcher<br>        │                      └─Dumper<br>        ├─security-core<br>        │  └─Symfony<br>        │      └─Component<br>        │          └─Security<br>        │              └─Core<br>        │                  ├─Authentication<br>        │                  │  ├─Provider<br>        │                  │  ├─RememberMe<br>        │                  │  └─Token<br>        │                  ├─Authorization<br>        │                  │  └─Voter<br>        │                  ├─Encoder<br>        │                  ├─Event<br>        │                  ├─Exception<br>        │                  ├─Resources<br>        │                  │  └─translations<br>        │                  ├─Role<br>        │                  ├─Tests<br>        │                  │  ├─Authentication<br>        │                  │  │  ├─Provider<br>        │                  │  │  ├─RememberMe<br>        │                  │  │  └─Token<br>        │                  │  ├─Authorization<br>        │                  │  │  └─Voter<br>        │                  │  ├─Encoder<br>        │                  │  ├─Role<br>        │                  │  ├─User<br>        │                  │  ├─Util<br>        │                  │  └─Validator<br>        │                  │      └─Constraints<br>        │                  ├─User<br>        │                  ├─Util<br>        │                  └─Validator<br>        │                      └─Constraints<br>        └─translation<br>            └─Symfony<br>                └─Component<br>                    └─Translation<br>                        ├─Catalogue<br>                        ├─Dumper<br>                        ├─Exception<br>                        ├─Extractor<br>                        ├─Loader<br>                        │  └─schema<br>                        │      └─dic<br>                        │          └─xliff-core<br>                        ├─Tests<br>                        │  ├─Catalogue<br>                        │  ├─Dumper<br>                        │  ├─fixtures<br>                        │  │  └─resourcebundle<br>                        │  │      ├─corrupted<br>                        │  │      ├─dat<br>                        │  │      └─res<br>                        │  └─Loader<br>                        └─Writer<br>几个注意事项：</p>
<ol>
<li><p><code>app/storage</code>需要开启可写权限</p>
</li>
<li><p><code>php5.4</code>以上, 并且安装<code>MCrypt PHP 扩展</code>，对<code>php5.5</code>,部分系统需要手动安装php-json扩展</p>
</li>
<li><p>修改 <code>app/config/app.php</code> 部分配置，如timezone和locale,生产环境下app.debug不要使用true. </p>
</li>
<li><p>路径配置文件，<code>bootstrap/paths.php</code></p>
</li>
<li><p>laravel4 中需要打开<code>php_openssl</code>扩展,否则会报错。<br><a href="http://laravel.io/forum/04-18-2014-you-need-to-specify-a-file-path-to-store-the-seed" target="_blank">http://laravel.io/forum/04-18-2014-you-need-to-specify-a-file-path-to-store-the-seed</a></p>
</li>
</ol>
]]></content>
    
    
      <category term="PHP" scheme="http://falconchen.github.io/tags/PHP/"/>
    
      <category term="laravel" scheme="http://falconchen.github.io/tags/laravel/"/>
    
      <category term="PHP" scheme="http://falconchen.github.io/categories/PHP/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[partyline优化建议]]></title>
    <link href="http://falconchen.github.io/2014/07/03/partyline-optimize-advices/"/>
    <id>http://falconchen.github.io/2014/07/03/partyline-optimize-advices/</id>
    <published>2014-07-03T00:00:00.000Z</published>
    <updated>2014-07-03T03:41:42.000Z</updated>
    <content type="html"><![CDATA[<h3 id="安装浏览器扩展测试">安装浏览器扩展测试</h3>
<p><code>chrome扩展</code>: <a href="https://developers.google.com/speed/docs/insights/using_chrome" target="_blank">https://developers.google.com/speed/docs/insights/using_chrome</a></p>
<h3 id="图片、css、js静态资源缓存时间">图片、css、js静态资源缓存时间</h3>
<p>除对缓存有特殊要求的资源外， 资源的<code>缓存时间</code>使用expires响应头， 设置为一周以上，一年以下</p>
<h3 id="调整CSS结构加速首屏呈现速度">调整CSS结构加速首屏呈现速度</h3>
<p>提取并内嵌关键的css样式，延迟加载次要样式（在首屏呈现后加载）</p>
<p>将需要在首屏加载时使用的样式内嵌在<code>&lt;style&gt;</code> 内，次要样式使用js加载，如：</p>
<pre><code><span class="tag">&lt;<span class="title">html</span>&gt;</span>
  <span class="tag">&lt;<span class="title">head</span>&gt;</span>
    <span class="tag">&lt;<span class="title">style</span>&gt;</span><span class="css">
      <span class="class">.blue</span><span class="rules">{<span class="rule"><span class="attribute">color</span>:<span class="value">blue</span></span>;<span class="rule">}</span></span>
    </span><span class="tag">&lt;/<span class="title">style</span>&gt;</span>
    <span class="tag">&lt;/<span class="title">head</span>&gt;</span>
  <span class="tag">&lt;<span class="title">body</span>&gt;</span>
    <span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"blue"</span>&gt;</span>
      Hello, world!
    <span class="tag">&lt;/<span class="title">div</span>&gt;</span>
    <span class="tag">&lt;<span class="title">script</span>&gt;</span><span class="javascript">
      <span class="keyword">var</span> cb = <span class="function"><span class="keyword">function</span><span class="params">()</span> {</span>
        <span class="keyword">var</span> l = document.createElement(<span class="string">'link'</span>); l.rel = <span class="string">'stylesheet'</span>;
        l.href = <span class="string">'small.css'</span>;
        <span class="keyword">var</span> h = document.getElementsByTagName(<span class="string">'head'</span>)[<span class="number">0</span>]; h.parentNode.insertBefore(l, h);
      };
      <span class="keyword">var</span> raf = requestAnimationFrame || mozRequestAnimationFrame ||
          webkitRequestAnimationFrame || msRequestAnimationFrame;
      <span class="keyword">if</span> (raf) raf(cb);
      <span class="keyword">else</span> window.addEventListener(<span class="string">'load'</span>, cb);
    </span><span class="tag">&lt;/<span class="title">script</span>&gt;</span>
  <span class="tag">&lt;/<span class="title">body</span>&gt;</span>
<span class="tag">&lt;/<span class="title">html</span>&gt;</span>
</code></pre><p>减少首屏内容大小：<br><a href="https://developers.google.com/speed/docs/insights/PrioritizeVisibleContent" target="_blank">https://developers.google.com/speed/docs/insights/PrioritizeVisibleContent</a></p>
<p>优化css推送：<br><a href="https://developers.google.com/speed/docs/insights/OptimizeCSSDelivery" target="_blank">https://developers.google.com/speed/docs/insights/OptimizeCSSDelivery</a></p>
<h3 id="精简压缩html,css,js">精简压缩html,css,js</h3>
<ul>
<li>chrome扩展提供精简后的html</li>
<li>css压缩可使用<a href="http://www.phpied.com/cssmin-js/" target="_blank">cssmin.js</a> 和<br><a href="http://developer.yahoo.com/yui/compressor/" target="_blank">YUI<br>Compressor</a></li>
<li>js压缩可使用<a href="http://www.crockford.com/javascript/jsmin.html" target="_blank">JSMin</a>和<a href="http://developer.yahoo.com/yui/compressor/" target="_blank">YUI<br>Compressor</a></li>
</ul>
<p>参考：<a href="https://developers.google.com/speed/docs/insights/MinifyResources" target="_blank">https://developers.google.com/speed/docs/insights/MinifyResources</a></p>
<h3 id="图片压缩">图片压缩</h3>
<ul>
<li>图片格式选择：<code>png</code>格式各方面优于<code>gif</code> , 尽量使用<code>png</code>替代<code>gif</code>格式的图片,仅对简单图像，如小于10x10像素或少于三种颜色的图像。对照片类图片使用<code>jpg</code>格式，不要使用<code>bmp</code>或者<code>tiff</code>格式。</li>
</ul>
<ul>
<li><p>使用<code>jpegtran</code>压缩<code>jpg</code></p>
<ul>
<li><a href="http://jpegclub.org/jpegtran/" target="_blank">文档和下载</a></li>
<li><a href="http://blog.csdn.net/lan861698789/article/details/7738381" target="_blank">如何使用jpegtran - 蓝天白云 - 博客频道 - CSDN.NET</a></li>
</ul>
</li>
</ul>
<ul>
<li><p>使用 <code>optipng</code> 压缩 <code>png</code></p>
<ul>
<li><a href="http://optipng.sourceforge.net/" target="_blank">主页</a> </li>
<li><a href="http://optipng.sourceforge.net/optipng-0.7.5.man.pdf" target="_blank">手册（PDF格式）</a></li>
</ul>
</li>
</ul>
<p>需要动态处理的图片(如新闻图片)，可以使用在程序内调用对应的上述外部程序，如上传图片成功后，php中可使用<code>exec</code>，<code>system</code>等函数调用jpegtran或optipng操作图片,如果能找到使用编程语言存在精简压缩处理图片的类库或函数，请使用类库或函数处理更好。</p>
<p>固定的图片如css样式图片,背景图片，icon等，可以直接使用 <code>chrome扩展</code> 保存处理后的图片或对应压缩工具处理过的图片来替换。</p>
<hr>
<h3 id="服务器架构方案,安装服务器模块自动优化">服务器架构方案,安装服务器模块自动优化</h3>
<p>pagespeed有服务器自动优化模块，当前只支持nginx和apache。</p>
<p>在源服务器跟squid之间加入一层(或者直接使用nginx或者apache做反向代理)，放入一个nginx（安装ngx_pagespeed模块）服务器,为节省带宽，最好是跟squid在同一服务器或同一内网，nginx作为源服务器的反向代理，squid作为nginx的反向代理和缓存服务器。缺点是占用部分服务器资源。响应时间可能略有增加。</p>
<p>ngx_pagespeed能完成基础优化。这是测试站点得分，与设想架构不同的是，这是在squid外包装了nginx作为反向代理。测试服务器在北京，存取香港服务器速度很慢，因而响应时间一项得分表现不佳</p>
<p><img src="http://i.imgur.com/nfVo6SV.jpg" alt=""></p>
]]></content>
    
    
      <category term="服务器" scheme="http://falconchen.github.io/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8/"/>
    
      <category term="前端" scheme="http://falconchen.github.io/tags/%E5%89%8D%E7%AB%AF/"/>
    
      <category term="服务器" scheme="http://falconchen.github.io/categories/%E6%9C%8D%E5%8A%A1%E5%99%A8/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[wordpress filter and action]]></title>
    <link href="http://falconchen.github.io/2014/06/20/wordpress-filter-and-action/"/>
    <id>http://falconchen.github.io/2014/06/20/wordpress-filter-and-action/</id>
    <published>2014-06-20T07:38:09.000Z</published>
    <updated>2014-06-20T07:38:09.000Z</updated>
    <content type="html"><![CDATA[]]></content>
    
    
  </entry>
  
  <entry>
    <title><![CDATA[文件系统损坏原因]]></title>
    <link href="http://falconchen.github.io/2014/06/20/file-system-broken-reasons/"/>
    <id>http://falconchen.github.io/2014/06/20/file-system-broken-reasons/</id>
    <published>2014-06-20T02:16:22.000Z</published>
    <updated>2014-06-20T02:19:23.000Z</updated>
    <content type="html"><![CDATA[<p>原因：<br>关于昨天服务器文件系统损坏的原因，我怀疑可能是这样的，上周给服务器装了个<code>ngx_pagespeed</code>，一个用来提高网站性能的nginx模块，它运行时产生大量的cache文件（按默认设置放在系统盘的/var/目录上）。网站高访问量时会对cache文件进行高速读写，可能这样导致系统盘的文件系统损坏。</p>
<p>现在新服务器上把这些cache放在单独的临时文件系统分区，跟系统盘分离了。</p>
]]></content>
    
    
      <category term="文件系统" scheme="http://falconchen.github.io/tags/%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/"/>
    
      <category term="服务器" scheme="http://falconchen.github.io/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8/"/>
    
      <category term="服务器" scheme="http://falconchen.github.io/categories/%E6%9C%8D%E5%8A%A1%E5%99%A8/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Windows批处理备份mysql]]></title>
    <link href="http://falconchen.github.io/2014/06/20/windows-bat-backup-mysql/"/>
    <id>http://falconchen.github.io/2014/06/20/windows-bat-backup-mysql/</id>
    <published>2014-06-20T02:04:03.000Z</published>
    <updated>2014-06-20T02:09:44.000Z</updated>
    <content type="html"><![CDATA[<p>服务器使用windows2008rc，用批处理写一个mysql的备份脚本，放到Windows计划任务，每天零时执行。</p>
<ul>
<li>使用mysql自带的 <code>mysqldump</code> 命令备份整个数据库</li>
<li>使用好压的命令行压缩</li>
<li>保留一周备份文件</li>
<li>写入日志</li>
</ul>
<p>详细代码如下：</p>
<pre><code><span class="variable">@echo</span> off
set <span class="string">"ymd=%date:~,4%%date:~5,2%%date:~8,2%"</span>
set storeDir=<span class="string">"F:\databases\%ymd%"</span>
set /<span class="constant">A</span> keepFromDay=%ymd<span class="string">%-7

md %storeDir% 2&gt;nul
"E:\xampp\mysql\bin\mysqldump.exe"  -</span>u用户名 -p密码 --lock-tables   --all-databases &gt; %storeDir%\db.sql <span class="number">2</span>&gt;nul
echo <span class="constant">Haozip</span> loading...
cd /d %storeDir%

<span class="string">"C:\Program Files\HaoZip\HaoZipC.exe"</span> a -tzip db.sql.zip db.sql
del /q db.sql

rem del <span class="number">7</span> days backup files
<span class="variable">@echo</span> off

<span class="keyword">for</span> /f <span class="string">%%i in ('dir /b ..\') do (
   if %</span>%i <span class="constant">LSS</span> %keepFromDay%   (
    echo deleting <span class="string">%%i 
    rd /s /q "F:\databases\%%</span>i<span class="string">" 
   )    
)

echo Finish at  %date% %time%  &gt;&gt; ../backup.log</span>
</code></pre>]]></content>
    
    
      <category term="mysql" scheme="http://falconchen.github.io/tags/mysql/"/>
    
      <category term="bat" scheme="http://falconchen.github.io/tags/bat/"/>
    
      <category term="windows" scheme="http://falconchen.github.io/tags/windows/"/>
    
      <category term="服务器" scheme="http://falconchen.github.io/categories/%E6%9C%8D%E5%8A%A1%E5%99%A8/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Firefox搜索栏修改]]></title>
    <link href="http://falconchen.github.io/2014/06/13/firefox-search-bar-modify/"/>
    <id>http://falconchen.github.io/2014/06/13/firefox-search-bar-modify/</id>
    <published>2014-06-13T03:18:52.000Z</published>
    <updated>2014-06-13T04:02:01.000Z</updated>
    <content type="html"><![CDATA[<p>谷歌搜索挂了好几天了，对于技术人员来说真是十分痛苦的事情，众所周知，搜索技术相关的内容google的结果能甩百度好几条街。除了翻墙之外，我发现另外一个好东西：<a href="http://www.gfsoso.com/" target="_blank">谷粉搜搜</a></p>
<blockquote>
<p>谷歌搜索-谷粉搜搜：由谷歌粉丝联合建立的方便大家稳定高速地使用谷歌搜索的搜索引擎。谷歌搜索如果您所在地区无法打开google或者比较卡，欢迎使用谷粉搜搜进行谷歌搜索。</p>
</blockquote>
<p>原理应该这样的：在获取用户输入的查询关键字后，通过在墙外的服务器提交到google服务器,取得响应内容后，再将结果返回给用户，也就是间接给你翻了个墙。当然它可以对结果进行一些处理，比如改变样式甚至加点广告什么的。</p>
<h3 id="把谷粉搜搜加入firefox搜索栏">把谷粉搜搜加入firefox搜索栏</h3>
<p>首先找到firefox的 Profile文件夹下的searchplugins目录，也就是在你个人设置的文件夹下，如：<code>G:\falconDisk\firefox\Profiles\</code> ,如果没有自己定义，则在firefox安装目录的browser下。新建一个<code>wwwgooglecomhk.xml</code>文件 ,写入以下内容，重启firefox即可，妈妈再也不用担心我的搜索了。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
</pre></td><td class="code"><pre><span class="tag">&lt;<span class="title">SearchPlugin</span> <span class="attribute">xmlns</span>=<span class="value">"http://www.mozilla.org/2006/browser/search/"</span> <span class="attribute">xmlns:os</span>=<span class="value">"http://a9.com/-/spec/opensearch/1.1/"</span>&gt;</span>
<span class="tag">&lt;<span class="title">os:ShortName</span>&gt;</span>谷粉搜搜<span class="tag">&lt;/<span class="title">os:ShortName</span>&gt;</span>
<span class="tag">&lt;<span class="title">os:Description</span>&gt;</span>打不开就用谷粉搜搜<span class="tag">&lt;/<span class="title">os:Description</span>&gt;</span>
<span class="tag">&lt;<span class="title">os:InputEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="title">os:InputEncoding</span>&gt;</span>
<span class="tag">&lt;<span class="title">os:Image</span> <span class="attribute">width</span>=<span class="value">"16"</span> <span class="attribute">height</span>=<span class="value">"16"</span>&gt;</span>data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAADRUlEQVQ4jSXT60/VdQDH8c/vd7AlI4EHtjW0WCs1i7U2i8u54GWxYDVtpkabumX5JLs86oLYEgRDQjAIBbsYayTmCjDQMwsrtcgxUBdWkNyyJDkCB9jRw+/8vu8e8OD9D7y2tyTJiUFX/wipWxuJe/pzSo9fwiVGNDzB2ewsei0xa9u4Eq5sIpYYl5AkxRwwwLriU2hTEHtbFwte/I6//p0CEyPyWy/XE+JxJYzlwbVExBIhxTFkCwE4jsMDO9rRtk60vQfl/0jxN5fBgInBUE4OUVnEPCJqWUzKw5glBiVkXCAG3sIO7M0/Y2/vxH7hHJv2dwMOAFfXr2NGcWAJVx6mLfGPRJ/tQeACLkVNl9H6IHEvXcB+/nvyqzpxMXAbfnloGT/dcwctS5JpT02mK2kew7botYT6h29igNFwhGU72tBzp1mwOUiw5xoGqGs5zOI3UtFH6Xhq/ajay/yyJ8h6OY19DyeipVs+43jHFXANE1NRjpwZoG/kJi6GklN1qOgRPPVePIeyUG06qs3EOpCFqrOx9q5GCzceJWntx6x+vZE9DR1zajic6fsV+6370OHHUV06qk/HqvFh1fhQZQZWuR9rbwAtzW9g0YYvuDPvU5KfOsTgaBhjDMOhayypfxbVpGEfzMQ+6EU1GdgferEq/djlflSWge7P3U/Glk/Y+G4rr1X9QE/fOC4Gg8vY1Bg5R1/BqkhDtT5U7Z2r0o/2+dEeP2o8fZGxcRcDzE72Mnq1mYGeWm5N3wBgNuaQ2/gqVsVyVJ2BqrzY5ZnofR8q8SFcmP7vIt3NGQw2x/N3mxj52uZK03LCoT/BxPh9dIi7SrNRVSaeD3zYZX5UEkC7A+i2M0NXYzoT3wpz3sY5G0+kYz43jon+5jyMMZgYPHhgAypbgSq8qNTPvN1rsHYF0FRogD8aUrgVTCIcTGCqLZHJ1kRmTqRw/atHITpNxDEsLslDpZnYJatQqQ/7vZVopx85McPgya2EvkxgsuVuwq0LmTmRQvjYvYyfK8QATRdO4nnzMaxiL56ibLQrgAoC6J01c0c6MyHGzhcy0b6WcMuTTLQ/Q6S7mqgT4dLwAIvezkUFK7ALs1HhSrTThwpWIUn/A1g/hnpCRmiJAAAAAElFTkSuQmCC<span class="tag">&lt;/<span class="title">os:Image</span>&gt;</span>
<span class="tag">&lt;<span class="title">SearchForm</span>&gt;</span>http://www.gfsoso.com/<span class="tag">&lt;/<span class="title">SearchForm</span>&gt;</span>
<span class="tag">&lt;<span class="title">os:Url</span> <span class="attribute">type</span>=<span class="value">"text/html"</span> <span class="attribute">method</span>=<span class="value">"GET"</span> <span class="attribute">template</span>=<span class="value">"http://www.gfsoso.com/"</span>&gt;</span>
	<span class="tag">&lt;<span class="title">os:Param</span> <span class="attribute">name</span>=<span class="value">"q"</span> <span class="attribute">value</span>=<span class="value">"{searchTerms}"</span>/&gt;</span>
<span class="tag">&lt;/<span class="title">os:Url</span>&gt;</span>
<span class="tag">&lt;/<span class="title">SearchPlugin</span>&gt;</span>
</pre></td></tr></table></figure>]]></content>
    
    
      <category term="firefox" scheme="http://falconchen.github.io/tags/firefox/"/>
    
      <category term="google" scheme="http://falconchen.github.io/tags/google/"/>
    
      <category term="搜索" scheme="http://falconchen.github.io/tags/%E6%90%9C%E7%B4%A2/"/>
    
      <category term="开发工具" scheme="http://falconchen.github.io/categories/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[php-fpm优化]]></title>
    <link href="http://falconchen.github.io/2014/06/12/php-fpm%E4%BC%98%E5%8C%96/"/>
    <id>http://falconchen.github.io/2014/06/12/php-fpm优化/</id>
    <published>2014-06-12T06:07:40.000Z</published>
    <updated>2014-06-12T08:00:40.000Z</updated>
    <content type="html"><![CDATA[<h3 id="当前内存使用情况">当前内存使用情况</h3>
<p><figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
</pre></td><td class="code"><pre>[root<span class="variable">@cpp22</span> ~]<span class="comment"># free -m</span>
			total       used       free     shared    buffers     cached
<span class="constant">Mem</span><span class="symbol">:</span>          <span class="number">7870</span>       <span class="number">7736</span>        <span class="number">134</span>          <span class="number">0</span>       <span class="number">1009</span>       <span class="number">5010</span>
-<span class="regexp">/+ buffers/cache</span><span class="symbol">:</span>       <span class="number">1716</span>       <span class="number">6154</span>
<span class="constant">Swap</span><span class="symbol">:</span>         <span class="number">2047</span>          <span class="number">0</span>       <span class="number">2047</span>
</pre></td></tr></table></figure></p>
<h3 id="查看php-fpm进程是否够用：">查看php-fpm进程是否够用：</h3>
<p>使用 </p>
<p><figure class="highlight bash"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>netstat -napo |grep <span class="string">"php-fpm"</span> | wc <span class="operator">-l</span>
</pre></td></tr></table></figure><br>查看一下当前fastcgi进程个数，如果个数接近conf里配置的上限，就需要调高进程数。</p>
<h3 id="php最大执行时间的设置">php最大执行时间的设置</h3>
<p>如果file_get_contents请求的远程资源如果反应过慢，file_get_contents就会一直卡在那里不会超时。我们知道php.ini 里面max_execution_time 可以设置 PHP 脚本的最大执行时间，但是，在 php-cgi(php-fpm) 中，该参数不会起效。真正能够控制 PHP 脚本最大执行时间的是 php-fpm.conf 配置文件中的request_terminate_timeout参数。</p>
<h3 id="pm-*的设置">pm.*的设置</h3>
<p>如果设置成static，php-fpm进程数自始至终都是pm.max_children指定的数量，不再增加或减少。如果设置成 dynamic，则php-fpm进程数是动态的，最开始是pm.start_servers指定的数量，如果请求较多，则会自动增加， 保证空闲的进程数不小于pm.min_spare_servers，如果进程数较多，也会进行相应清理，保证多余的进程数不多于 pm.max_spare_servers。</p>
]]></content>
    
    
      <category term="服务器" scheme="http://falconchen.github.io/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8/"/>
    
      <category term="php-fpm" scheme="http://falconchen.github.io/tags/php-fpm/"/>
    
      <category term="php" scheme="http://falconchen.github.io/tags/php/"/>
    
      <category term="服务器" scheme="http://falconchen.github.io/categories/%E6%9C%8D%E5%8A%A1%E5%99%A8/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[windows下ftp自动更新]]></title>
    <link href="http://falconchen.github.io/2014/06/10/windows-ftp-bat/"/>
    <id>http://falconchen.github.io/2014/06/10/windows-ftp-bat/</id>
    <published>2014-06-09T16:00:00.000Z</published>
    <updated>2014-06-10T10:28:48.000Z</updated>
    <content type="html"><![CDATA[<p>服务器（<code>windows 2008 RC2</code>)迁移到<code>阿里云</code>后， 原来的ftp自动更新脚本（php脚本，使用了ftp模块的函数）出现问题了，连接到海外的FTP服务器（澳大利亚的主机）后，列目录会出错，具体就是<code>ftp_nlist</code>函数执行超时，无法下载文件，具体原因未知。</p>
<p>当前服务器已开通FTP服务，测试用FTP脚本连接本地FTP没有问题的，于是现在解决方案为：<br>在本地新建一个帐户，想办法用其他方法将海外FTP的文件同步到本地FTP，将FTP脚本的配置修改为本地连接的帐户，使用同步后的文件更新,这样自动更新脚本的逻辑无需更改。<br><a id="more"></a></p>
<h3 id="使用windows自带的ftp命令">使用windows自带的ftp命令</h3>
<p>先写一个批处理 <code>auto.ftp</code>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
</pre></td><td class="code"><pre>open aaa.com.au 
user 用户名
密码
dir 
get XXX.zip
bye
</pre></td></tr></table></figure>

<p>然后在命令行下执行：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>ftp -n <span class="operator">-s</span>:auto.ftp
</pre></td></tr></table></figure>

<p>在本地执行可成功列目录和下载文件，但是放到服务器执行，到列目录时半天没响应，尝试以失败告终。</p>
<h3 id="使用_wget">使用 <code>wget</code></h3>
<p>这是个在linux下很流行的一个工具，在windows下也有相应的版本，它不但支持http协议，也支持FTP下载，下载后直接扔<code>%path%</code>目录里去就行了，完成写个批处理，内容如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
</pre></td><td class="code"><pre>rem 使用wget获取到本地ftp。
<span class="built_in">cd</span> /d F:\myftp
md logs
del *.zip*
wget ftp://aaa.com.au/file_%date:~<span class="number">0</span>,<span class="number">4</span>%%date:~<span class="number">5</span>,<span class="number">2</span>%.zip --ftp-user=用户名 --ftp-password=密码 
wget -q http://myhost/ftp-import.php --output-document=logs\%date:~<span class="number">0</span>,<span class="number">4</span>%%date:~<span class="number">5</span>,<span class="number">2</span>%%date:~<span class="number">8</span>,<span class="number">2</span>%.update.log
</pre></td></tr></table></figure>

<p>执行后文件将被下载到<code>f:\myftp</code>目录下。值得注意的是批处理的日期表示法。</p>
]]></content>
    <summary type="html"><![CDATA[<p>服务器（<code>windows 2008 RC2</code>)迁移到<code>阿里云</code>后， 原来的ftp自动更新脚本（php脚本，使用了ftp模块的函数）出现问题了，连接到海外的FTP服务器（澳大利亚的主机）后，列目录会出错，具体就是<code>ftp_nlist</code>函数执行超时，无法下载文件，具体原因未知。</p>
<p>当前服务器已开通FTP服务，测试用FTP脚本连接本地FTP没有问题的，于是现在解决方案为：<br>在本地新建一个帐户，想办法用其他方法将海外FTP的文件同步到本地FTP，将FTP脚本的配置修改为本地连接的帐户，使用同步后的文件更新,这样自动更新脚本的逻辑无需更改。<br>]]></summary>
    
      <category term="ftp" scheme="http://falconchen.github.io/tags/ftp/"/>
    
      <category term="windows" scheme="http://falconchen.github.io/tags/windows/"/>
    
      <category term="wget" scheme="http://falconchen.github.io/tags/wget/"/>
    
      <category term="服务器" scheme="http://falconchen.github.io/categories/%E6%9C%8D%E5%8A%A1%E5%99%A8/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[诡异的百度索引查询]]></title>
    <link href="http://falconchen.github.io/2014/06/09/fuck-baidu-index/"/>
    <id>http://falconchen.github.io/2014/06/09/fuck-baidu-index/</id>
    <published>2014-06-09T06:49:17.000Z</published>
    <updated>2014-06-09T08:02:36.000Z</updated>
    <content type="html"><![CDATA[<p>早上打开百度统计看看这些天网站的流量和索引量，不看不知道，一看吓一跳，索引量变成零了。</p>
<p><img src="http://falconchen.github.io/image/baidu_index1.jpg" alt="索引量为0"></p>
<p>然后下午吃饭回来一看，又给恢复回来了。</p>
<p><img src="http://falconchen.github.io/image/baidu_index2.jpg" alt="索引量恢复"></p>
<p>这是什么情况？百度最近抽风，没想到百度统计也这么坑爹的。</p>
<p>PS:本来这篇文章是在<code>liteIde</code>里写的，没想到插入图片的时候<code>liteIde</code>居然没响应了，没办法，只好先回到<code>MarkdownPad2</code>, Windows上还有没有更好的markdown书写工具？</p>
<p>PS2: 再然后发现了个破解版的：<a href="http://www.tt7z.com/html/MarkdownPad-Pro.html" target="_blank">http://www.tt7z.com/html/MarkdownPad-Pro.html</a> </p>
]]></content>
    
    
      <category term="seo" scheme="http://falconchen.github.io/tags/seo/"/>
    
      <category term="百度" scheme="http://falconchen.github.io/tags/%E7%99%BE%E5%BA%A6/"/>
    
      <category term="SEO" scheme="http://falconchen.github.io/categories/SEO/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[使用PageSpeed进行网站优化]]></title>
    <link href="http://falconchen.github.io/2014/06/05/pagespeed-insights-opt/"/>
    <id>http://falconchen.github.io/2014/06/05/pagespeed-insights-opt/</id>
    <published>2014-06-05T10:02:35.000Z</published>
    <updated>2014-06-05T10:30:15.000Z</updated>
    <content type="html"><![CDATA[<p>最近网站打开速度较慢，服务器带宽经常暴满，虽然从10m提高到15m，依然时常能达到锋值，ping值高达两三百毫秒，PageSpeed Insights得分仅为57。</p>
<p><a href="http://developers.google.com/speed/pagespeed/insights" target="_blank">pagespeed insight测试网址</a>，如果无法访问或者检测出错，请自觉翻墙.</p>
<h3 id="PageSpeed_Insights_简介">PageSpeed Insights 简介</h3>
<p>以下内容摘自：<a href="https://developers.google.com/speed/docs/insights/about" target="_blank">https://developers.google.com/speed/docs/insights/about</a><br><a id="more"></a></p>
<blockquote>
<p>Page Speed Insights能针对移动设备和桌面设备衡量网页的性能。该工具会抓取网址两次，一次是通过移动设备用户代理，另一次是通过桌面设备用户代理。</p>
<p>PageSpeed得分范围是从0到100分。分数越高，代表性能越好。85分或更高分表明网页性能良好。请注意，PageSpeed Insights正在不断改进，因此，分数可能会随着我们添加新规则或完善分析而发生变化。</p>
<p>PageSpeed Insights能根据以下内容衡量网页如何提升其性能：</p>
</blockquote>
<pre><code> 1.首屏加载时间：从用户请求新页面到浏览器呈现首屏内容所用的时间。

 2.完整的网页加载时间：从用户请求新网页到浏览器完全呈现网页所用的时间。
</code></pre><blockquote>
<p>然而，由于网络连接性能有很大差异，因此，PageSpeed Insights只考虑网页性能中与网络无关的方面：服务器配置、网页的HTML结构及其所用的外部资源（例如，图片、JavaScript和&gt; CSS）。实施这些建议应该能改进网页的相对性能。但网页的绝对性能将仍取决于用户的网络连接。</p>
</blockquote>
<p>PageSpeed同时提供浏览器插件和服务器模块。</p>
<ul>
<li><p>浏览器插件支持firefox跟chrome浏览器，Firefox插件需要先安装firebug，如果需要显示打分情况请在<code>about:config</code>中将<code>extensions.PageSpeed.show_score</code>改为true</p>
</li>
<li><p>服务器模块支持apache和nginx，安装后会根据<a href="https://developers.google.com/speed/docs/best-practices/rules_intro" target="_blank">Web Performance Best Practices</a>原则进行自动优化。</p>
</li>
</ul>
<h3 id="安装ngx_pagespeed模块">安装ngx_pagespeed模块</h3>
<p>生产环境使用的服务器为 nginx1.4.4，源代码编译安装</p>
<p>原服务器 <code>nginx</code> 编译参数：</p>
<pre><code>configure arguments: <span class="subst">--</span>prefix<span class="subst">=</span>/usr/<span class="built_in">local</span>/nginx <span class="subst">--</span><span class="keyword">with</span><span class="attribute">-http_sub_module</span> <span class="subst">--</span><span class="keyword">with</span><span class="attribute">-http_stub_status_module</span> <span class="subst">--</span><span class="keyword">with</span><span class="attribute">-http_geoip_module</span> <span class="subst">--</span><span class="keyword">with</span><span class="attribute">-http_mp4_module</span> <span class="subst">--</span><span class="keyword">with</span><span class="attribute">-http_ssl_module</span> <span class="subst">--</span><span class="keyword">with</span><span class="attribute">-http_realip_module</span> <span class="subst">--</span><span class="keyword">with</span><span class="attribute">-http_flv_module</span>
</code></pre><p>下载和编译：</p>
<pre><code>cd ~
wget https://github<span class="preprocessor">.com</span>/pagespeed/ngx_pagespeed/archive/release-<span class="number">1.7</span><span class="number">.30</span><span class="number">.4</span>-beta<span class="preprocessor">.zip</span>
unzip release-<span class="number">1.7</span><span class="number">.30</span><span class="number">.4</span>-beta<span class="preprocessor">.zip</span>
cd ngx_pagespeed-release-<span class="number">1.7</span><span class="number">.30</span><span class="number">.4</span>-beta/
wget https://dl<span class="preprocessor">.google</span><span class="preprocessor">.com</span>/dl/page-speed/psol/<span class="number">1.7</span><span class="number">.30</span><span class="number">.4</span><span class="preprocessor">.tar</span><span class="preprocessor">.gz</span>
tar -xzvf <span class="number">1.7</span><span class="number">.30</span><span class="number">.4</span><span class="preprocessor">.tar</span><span class="preprocessor">.gz</span> <span class="preprocessor"># expands to psol/</span>

cd ~
<span class="preprocessor"># check http://nginx.org/en/download.html for the latest version</span>
wget http://nginx<span class="preprocessor">.org</span>/download/nginx-<span class="number">1.4</span><span class="number">.4</span><span class="preprocessor">.tar</span><span class="preprocessor">.gz</span>
tar -xvzf nginx-<span class="number">1.4</span><span class="number">.4</span><span class="preprocessor">.tar</span><span class="preprocessor">.gz</span>
cd nginx-<span class="number">1.4</span><span class="number">.4</span>/
./configure --<span class="keyword">add</span>-module=$HOME/ngx_pagespeed-release-<span class="number">1.7</span><span class="number">.30</span><span class="number">.4</span>-beta
make
sudo make install
</code></pre><p>编译参数因人而异：</p>
<pre><code>[root<span class="keyword">@cpp76</span> nginx-<span class="number">1.4</span>.4]# ./configure --prefix=/usr/local/nginx --<span class="keyword">with</span>-http_sub_module --<span class="keyword">with</span>-http_stub_status_module --<span class="keyword">with</span>-http_geoip_module --<span class="keyword">with</span>-http_mp4_module --<span class="keyword">with</span>-http_ssl_module --<span class="keyword">with</span>-http_realip_module --<span class="keyword">with</span>-http_flv_module --add-<span class="keyword">module</span>=$HOME/ngx_pagespeed-release-<span class="number">1.7</span>.30.4-beta
[root<span class="keyword">@cpp76</span> nginx-<span class="number">1.4</span>.4]# mv /usr/sbin/nginx  /usr/sbin/nginx.old
[root<span class="keyword">@cpp76</span> nginx-<span class="number">1.4</span>.4]# ln -s /usr/local/nginx/sbin/nginx /usr/sbin/nginx
</code></pre><p>为立即生效，可使用暴力重启，测试发现，直接使用<code>nginx -s reload</code>并不生效</p>
<pre><code>[root<span class="variable">@cpp76</span> nginx-<span class="number">1.4</span>.<span class="number">4</span>]<span class="comment"># pkill -9 nginx </span>
[root<span class="variable">@cpp76</span> nginx-<span class="number">1.4</span>.<span class="number">4</span>]<span class="comment"># nginx</span>
</code></pre><p>生产机请使用优雅重启，会等待已建立的连接结束，再使用新安装的nginx重启线程</p>
<pre><code><span class="built_in">kill</span> -USR2 `cat /usr/<span class="built_in">local</span>/php/var/run/php-fpm.pid` 
</code></pre><p>附录：</p>
<ul>
<li><code>ngx_pagespeed</code> 最新版本为： <a href="https://github.com/pagespeed/ngx_pagespeed" target="_blank">https://github.com/pagespeed/ngx_pagespeed</a></li>
<li>如果使用<code>Tengine</code>,可动态加载模块:<a href="https://github.com/pagespeed/ngx_pagespeed/wiki/Using-ngx_pagespeed-with-Tengine" target="_blank">https://github.com/pagespeed/ngx_pagespeed/wiki/Using-ngx_pagespeed-with-Tengine</a></li>
</ul>
<h3 id="ngx_pagespeed_配置">ngx_pagespeed  配置</h3>
<p>配置详细文档见：<br><a href="http://ngxpagespeed.com/ngx_pagespeed_example/" target="_blank">http://ngxpagespeed.com/ngx_pagespeed_example/</a></p>
<p>我的配置：</p>
<pre><code> <span class="comment"># 启用ngx_pagespeed</span>
 pagespeed <span class="literal">on</span>;
 pagespeed FileCachePath /<span class="reserved">var</span>/ngx_pagespeed_cache;
 <span class="comment"># 禁用CoreFilters</span>
 pagespeed RewriteLevel PassThrough;
 <span class="comment"># 启用压缩空白过滤器</span>
 pagespeed EnableFilters collapse_whitespace;
 <span class="comment"># 启用JavaScript库卸载</span>
 pagespeed EnableFilters canonicalize_javascript_libraries;
 <span class="comment"># 把多个CSS文件合并成一个CSS文件</span>
 pagespeed EnableFilters combine_css;
 <span class="comment"># 把多个JavaScript文件合并成一个JavaScript文件</span>
 pagespeed EnableFilters combine_javascript;
 <span class="comment"># 删除带默认属性的标签</span>
 pagespeed EnableFilters elide_attributes;
 <span class="comment"># 改善资源的可缓存性</span>
 pagespeed EnableFilters extend_cache;
 <span class="comment"># 更换被导入文件的@import，精简CSS文件</span>
 pagespeed EnableFilters flatten_css_imports;
 pagespeed CssFlattenMaxBytes <span class="number">5120</span>;
 <span class="comment"># 延时加载客户端看不见的图片</span>
 pagespeed EnableFilters lazyload_images;
 <span class="comment"># 启用JavaScript缩小机制</span>
 pagespeed EnableFilters rewrite_javascript;
 <span class="comment"># 启用图片优化机制</span>
 pagespeed EnableFilters rewrite_images;
 <span class="comment"># 预解析DNS查询</span>
 pagespeed EnableFilters insert_dns_prefetch;
 <span class="comment"># 重写CSS，首先加载渲染页面的CSS规则</span>
 pagespeed EnableFilters prioritize_critical_css;
 <span class="comment"># 嵌入小的外部css文件</span>
 pagespeed EnableFilters inline_css;
 <span class="comment"># 嵌入小js</span>
 pagespeed EnableFilters inline_javascript;
 <span class="comment"># 移除html注释</span>
 pagespeed EnableFilters remove_comments;
 <span class="comment"># 重要的样式优先</span>
 pagespeed EnableFilters prioritize_critical_css;
 <span class="comment">#延迟执行js</span>
 pagespeed EnableFilters defer_javascript;
 <span class="comment">#css移到js前</span>
 pagespeed EnableFilters move_css_above_scripts;
</code></pre><p>放在<code>http{ }</code>标签内，重启nginx即可，如果遇到冲突,某些地址可禁用ngx_pagespeed,或者禁用某些filter.比如ngx_pagespeed开启<code>defer_javascript fileter</code>后会向xml文件加入一段js,可禁用。</p>
<pre><code> location ~*\.xml<span class="variable">$ </span>{
         pagespeed off;
 }
</code></pre><h3 id="ngx_pagespeed加速原理">ngx_pagespeed加速原理</h3>
<p>在nginx中通过自定义的filter 修改网页资源来实现网站最佳实践，达到降低网页延迟和减少带宽占用的目的。</p>
<ul>
<li>一些filter改变html结构，如压缩精简html,调整css与js位置</li>
<li>还有一些改变CSS, JavaScript, 如合并css和js文件，内嵌css</li>
<li>动态优化图片，自动生成无损和压缩的图片，通过脚本延迟加载图片</li>
<li>缓存控制，<code>ngx_pagespeed</code> 处理后的图片缓存时间为一年。</li>
</ul>
<p>ngx_pagespeed既可部署在独立服务器，也可部署到主机服务提供商，或者CDN主机上，提高站点性能、降低延迟和带宽占用。</p>
<h3 id="优化前后对比：">优化前后对比：</h3>
<ul>
<li><p>page speed insights: </p>
<p>  <img src="/image/pagespeed1.jpg" alt="优化前"></p>
<p>  <img src="/image/pagespeed2.jpg" alt="优化后"></p>
</li>
<li><p>网站速度诊断 :</p>
<p>  <img src="/image/baidu_speed1.jpg" alt="优化前"></p>
<p>  <img src="/image/baidu_speed2.jpg" alt="优化后"></p>
</li>
<li><p>带宽占用:</p>
</li>
</ul>
<p><img src="/image/bandwidth.jpg" alt="红线为优化后的带宽"></p>
<p>总的来说作用还是比较理想的</p>
<h3 id="关于最佳实践">关于最佳实践</h3>
<p>除了安装服务器模块外，其实还修改了部分模板，虽然有些做法需要符合最佳实践原则，像要把js要放在页脚，但因某些页面冲突，比如把<code>jquery.js</code>的加载放在页脚时，有些页面内嵌的js会使用到jquery 选择器，这时如果<code>jquery.js</code>放页脚就会出错。 当然也可以重构页面，不可一概而论，还是切合实际量力而行吧。</p>
<h3 id="参考资料">参考资料</h3>
<ul>
<li><p><a href="https://developers.google.com/speed/pagespeed/module" target="_blank">Make the Web Faster</a></p>
</li>
<li><p><a href="http://os.51cto.com/art/201402/428780.htm" target="_blank">如何借助PageSpeed，为Nginx网站服务器提速？ - 51CTO.COM</a></p>
</li>
<li><p><a href="http://ngxpagespeed.com/ngx_pagespeed_example/" target="_blank">PageSpeed Examples Directory</a></p>
</li>
<li><p><a href="https://developers.google.com/speed/docs/insights/about" target="_blank">PageSpeed Insights简介 - PageSpeed Insights — Google Developers</a></p>
</li>
<li><p><a href="https://github.com/pagespeed/ngx_pagespeed/wiki/Using-ngx_pagespeed-with-Tengine" target="_blank">Using ngx_pagespeed with Tengine · pagespeed/ngx_pagespeed Wiki · GitHub</a></p>
</li>
</ul>
]]></content>
    <summary type="html"><![CDATA[<p>最近网站打开速度较慢，服务器带宽经常暴满，虽然从10m提高到15m，依然时常能达到锋值，ping值高达两三百毫秒，PageSpeed Insights得分仅为57。</p>
<p><a href="http://developers.google.com/speed/pagespeed/insights" target="_blank">pagespeed insight测试网址</a>，如果无法访问或者检测出错，请自觉翻墙.</p>
<h3 id="PageSpeed_Insights_简介">PageSpeed Insights 简介</h3>
<p>以下内容摘自：<a href="https://developers.google.com/speed/docs/insights/about" target="_blank">https://developers.google.com/speed/docs/insights/about</a><br>]]></summary>
    
      <category term="pagespeed" scheme="http://falconchen.github.io/tags/pagespeed/"/>
    
      <category term="优化" scheme="http://falconchen.github.io/tags/%E4%BC%98%E5%8C%96/"/>
    
      <category term="前端" scheme="http://falconchen.github.io/tags/%E5%89%8D%E7%AB%AF/"/>
    
      <category term="nginx" scheme="http://falconchen.github.io/tags/nginx/"/>
    
      <category term="ngx_pagespeed" scheme="http://falconchen.github.io/tags/ngx_pagespeed/"/>
    
      <category term="服务器" scheme="http://falconchen.github.io/categories/%E6%9C%8D%E5%8A%A1%E5%99%A8/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[利用SSH隧道进行反向代理]]></title>
    <link href="http://falconchen.github.io/2014/05/29/%E5%88%A9%E7%94%A8ssh%E9%9A%A7%E9%81%93%E8%BF%9B%E8%A1%8C%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86/"/>
    <id>http://falconchen.github.io/2014/05/29/利用ssh隧道进行反向代理/</id>
    <published>2014-05-29T08:01:07.000Z</published>
    <updated>2014-05-29T10:02:31.000Z</updated>
    <content type="html"><![CDATA[<p>公司有几个网站要迁移到<code>阿里云</code>，数据已经被我迁移过去了，域名还在备案，使用未备案的域名访问，阿里云是会直接封锁的，万恶的备案！！！</p>
<p>公司有一个临时方案，把域名和数据暂时放在北京office的一台Linux服务器上，备案通过后再切换到阿里云服务器，但是当把数据弄到临时服务器后，突然发现网站的一个功能模块出现兼容性问题，代码里很多地方是针对windows处理的， 由于开发机和原服务器都是windows系统，在<code>文件目录分隔符</code>、<code>系统字符编码</code>等一些地方没有考虑到linux的情形，而且这模块不是我开发的, 代码写得有些凌乱,改了两天也算勉强能用了。<br><a id="more"></a><br>还有一个问题，北京office的服务器似乎不太稳定，SSH连接偶尔还会掉线，这个影响后面的部署和选择。</p>
<p>我想来想去，最终觉得用反向代理处理。好处是显而易见的：</p>
<ol>
<li><p>解决代码的平台兼容性问题</p>
</li>
<li><p>不用重复迁移，否则当域名备案成功后还要把临时服务器的数据转移到阿里云来，不堪其扰。</p>
</li>
</ol>
<h3 id="正常反向代理">正常反向代理</h3>
<ol>
<li><p>在阿里云上安装必要的软件，配置网站，这里使用<code>apache</code> , 开放服务器80端口。</p>
</li>
<li><p>在临时服务器上配置反向代理，这里我使用<code>nginx</code>,配置如下：</p>
 <figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
</pre></td><td class="code"><pre>server{		
    listen  <span class="number">80</span>;
    server_name 域名<span class="number">1</span> 域名<span class="number">2</span>;
    access_log /<span class="keyword">log</span>/web/access.<span class="keyword">log</span>;
    location / {
           proxy_pass http:<span class="comment">//阿里云主机IP:80;</span>
           include proxy.conf;
       }	
   }
</pre></td></tr></table></figure>
</li>
<li><p>重启nginx后即生效，访问似乎正常，几分钟后域名被拦截了，意料之中，反向代理访问在后端主机看来跟正常访问其实是一样的，都是常规的<code>http请求</code>，阿里云根据请求头的信息拦截。</p>
</li>
</ol>
<p><img src="/image/aliyunban.jpg" alt="阿里云拦截"></p>
<p>一句话说白了，<em>此路不通</em></p>
<h3 id="结合SSH_Forward的反向代理">结合SSH Forward的反向代理</h3>
<p>先看命令，在阿里云上执行：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>c:\ssh -R <span class="number">7002</span>:localhost:<span class="number">80</span> 用户名@远程主机IP
</pre></td></tr></table></figure>

<p>这条命令的意思是在阿里云服务器向临时服务器建立一个ssh连接，将阿里云的80端口映射到临时服务器的7002端口，这样请求临时服务器的7002端口数据时，就会被转发往阿里云服务器的80端口，而且借助SSH隧道，还实现了<code>加密传输</code>，于是阿里云的系统根本不能拦截。</p>
<p>同时临时服务器nginx做以下配置：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
</pre></td><td class="code"><pre>server{		
	    listen  80;
	    server_name 域名1 域名2;
	    access_log /log/web/access.log;
	    location / {
	           proxy_pass http://127.0.0.1:7002;
	           include proxy.conf;
	       }	
	   }
</pre></td></tr></table></figure>    

<p>可以看到跟正常反向代理相比，只是将<code>proxy_pass</code>修改了,原来防火墙的配置也不用修改。</p>
<p>在Windows下除了安装<code>openssh</code>的命令行执行外，还可以在 <code>putty</code>,<code>bitvise</code>一些客户端设置。推荐使用bitvise,因为掉线后会自动重连。</p>
<p><img src="/image/puttys2c.jpg" alt="putty设置"></p>
<p><img src="/image/bitvises2c.jpg" alt="bitvise设置"></p>
<h3 id="Apache的日志格式修改">Apache的日志格式修改</h3>
<p>使用反向代理后，后端的apache就不能直接取得<code>访客真实IP</code>了，在代理服务器nginx的<code>proxy.conf</code>可见如下内容：</p>
<pre><code>proxy_set_header        X<span class="attribute">-Real</span><span class="attribute">-IP</span> <span class="variable">$remote_addr</span>
proxy_set_header       X<span class="attribute">-Forwarded</span><span class="attribute">-For</span>   <span class="variable">$proxy_add_x_forwarded_for</span>;
</code></pre><p>即为转发到apache上的请求增加了两个请求头<code>X-Real-IP</code>和<code>X-Forwarded-For</code>。</p>
<p>Apache的<code>http.conf</code>配置日志格式增加一条：</p>
<pre><code><span class="comment">#reverse proxy backend</span>
LogFormat <span class="string">"%{X-Forwarded-For}i <span class="variable">%l</span> <span class="variable">%u</span> <span class="variable">%t</span> \"<span class="variable">%r</span>\" <span class="variable">%&gt;</span>s <span class="variable">%b</span>"</span> backend
</code></pre><p><code>http-vhosts.conf</code>相关配置修改为：</p>
<pre><code>CustomLog <span class="string">"path/to/log"</span> backend
</code></pre><h3 id="参考资料">参考资料</h3>
<ul>
<li><p><a href="http://www.ruanyifeng.com/blog/2011/12/ssh_port_forwarding.html" target="_blank">SSH原理与运用（二）：远程操作与端口转发 - 阮一峰的网络日志</a></p>
</li>
<li><p><a href="http://www.ibm.com/developerworks/cn/linux/l-cn-sshforward/" target="_blank">实战 SSH 端口转发</a></p>
</li>
<li><p><a href="http://yansu.org/2014/01/24/apache-log-format.html" target="_blank">Apache 日志文件格式及简单处理 | 闫肃的博客</a></p>
</li>
</ul>
]]></content>
    <summary type="html"><![CDATA[<p>公司有几个网站要迁移到<code>阿里云</code>，数据已经被我迁移过去了，域名还在备案，使用未备案的域名访问，阿里云是会直接封锁的，万恶的备案！！！</p>
<p>公司有一个临时方案，把域名和数据暂时放在北京office的一台Linux服务器上，备案通过后再切换到阿里云服务器，但是当把数据弄到临时服务器后，突然发现网站的一个功能模块出现兼容性问题，代码里很多地方是针对windows处理的， 由于开发机和原服务器都是windows系统，在<code>文件目录分隔符</code>、<code>系统字符编码</code>等一些地方没有考虑到linux的情形，而且这模块不是我开发的, 代码写得有些凌乱,改了两天也算勉强能用了。<br>]]></summary>
    
      <category term="ssh" scheme="http://falconchen.github.io/tags/ssh/"/>
    
      <category term="服务器" scheme="http://falconchen.github.io/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8/"/>
    
      <category term="nginx" scheme="http://falconchen.github.io/tags/nginx/"/>
    
      <category term="服务器" scheme="http://falconchen.github.io/categories/%E6%9C%8D%E5%8A%A1%E5%99%A8/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[hexo生成css的问题]]></title>
    <link href="http://falconchen.github.io/2014/05/28/hexo-css-issue/"/>
    <id>http://falconchen.github.io/2014/05/28/hexo-css-issue/</id>
    <published>2014-05-28T03:30:59.000Z</published>
    <updated>2014-05-28T03:31:06.000Z</updated>
    <content type="html"><![CDATA[<p>修改了主题的样式文件如：<code>layout.styl</code><br>在本地预览是可以即时看到效果的，但是当执行<code>hexo g</code>,在<code>public</code>目录下的 <code>style.css</code>却没有发生修改，<code>hexo d</code>部署时也是没有修改版本的样式，不清楚具体原因，现在的解决方法是修改完主题样式后，删除<code>public</code>下的<code>style.css</code>,再重新生成方可生效。</p>
]]></content>
    
    
      <category term="hexo" scheme="http://falconchen.github.io/tags/hexo/"/>
    
      <category term="css" scheme="http://falconchen.github.io/tags/css/"/>
    
      <category term="hexo" scheme="http://falconchen.github.io/categories/hexo/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[hello LiteIde]]></title>
    <link href="http://falconchen.github.io/2014/05/28/hello-liteIde/"/>
    <id>http://falconchen.github.io/2014/05/28/hello-liteIde/</id>
    <published>2014-05-27T16:00:00.000Z</published>
    <updated>2014-05-28T04:21:14.000Z</updated>
    <content type="html"><![CDATA[<p>一直用 <code>markdownPad2</code> 写作，但毕竟是个商业软件，限制还是太多，尤其是它不支持github的扩展markdown语法高亮,今天换成<code>LiteIde</code>了，一个Go语言的IDE，用着还挺顺手的，启动速度也很快，不仅有html即时预览，还有文件目录列表，还可以右键启动命令行终端（这个对我很重要，可以进入<code>hexo</code>,编译和发布文章到<code>github</code>），支持<code>markdown语法高亮</code>，支持导出为<code>PDF格式</code> ，这些功能都是<code>markdownPad2</code>收费版才有的，甚至还能自定义css，支持多个平台。</p>
<p>windows版的下载地址：<br><a href="https://golangide.googlecode.com/files/liteidex19.windows.7z" target="_blank">https://golangide.googlecode.com/files/liteidex19.windows.7z</a></p>
<p><img src="/image/LiteIde.jpg" alt="liteIde"></p>
]]></content>
    
    
      <category term="markdown" scheme="http://falconchen.github.io/tags/markdown/"/>
    
      <category term="IDE" scheme="http://falconchen.github.io/tags/IDE/"/>
    
      <category term="liteIde" scheme="http://falconchen.github.io/tags/liteIde/"/>
    
      <category term="开发工具" scheme="http://falconchen.github.io/categories/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[微信开发笔记[0]:搭建开发测试环境]]></title>
    <link href="http://falconchen.github.io/2014/05/27/%E5%BE%AE%E4%BF%A1%E5%BC%80%E5%8F%91%5B0%5D-%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E6%B5%8B%E8%AF%95%E7%8E%AF%E5%A2%83/"/>
    <id>http://falconchen.github.io/2014/05/27/微信开发[0]-搭建开发测试环境/</id>
    <published>2014-05-27T03:34:26.000Z</published>
    <updated>2014-05-28T09:45:02.000Z</updated>
    <content type="html"><![CDATA[<p>概况：</p>
<ul>
<li><p>本地开发机 <code>win7</code> ,计算机名：<code>FALCON-PC</code> ,公司内网无法进行80端口映射.已安装 <code>nginx+php+mysql</code></p>
</li>
<li><p>外网测试机环境为<code>centos6.4</code>，主机名<code>cpp65</code> 。已安装<code>nginx</code></p>
</li>
<li><p>使用域名 <code>65.hihoku.com</code> 进行开发测试，A记录已指向<code>cpp65</code></p>
</li>
</ul>
<p>搭建目标：</p>
<ul>
<li>微信服务器能直接与本地开发机通讯，本地开发即时看到调试效果</li>
</ul>
<p>原理和实现：</p>
<ul>
<li><p>由于微信服务器不能直接访问内网的开发机，所以先让微信服务器访问外网测试主机，测试主机通过ssh隧道将请求转发至开发机，取得开发机响应的数据后，再返回给微信服务器。</p>
</li>
<li><p>SSH Forward 远程端口转发（<code>S2C</code>模式）+ <code>nginx反向代理</code> </p>
</li>
</ul>
<a id="more"></a> 

<p>实施步骤：</p>
<h3 id="Step1:_@_win7_给nginx_增加一条配置如下：">Step1:  <code>@ win7</code> 给nginx 增加一条配置如下：</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre></td><td class="code"><pre>server {
        listen       <span class="number">80</span>;
        server_name  <span class="number">65</span>.hihoku.com;
        <span class="keyword">set</span> <span class="variable">$generater</span> <span class="string">"wordpress"</span>;
        <span class="comment">#charset koi8-r;</span>
        <span class="comment">#access_log  logs/host.access.log  main;</span>
        location / {
          root   F:/kuaipan/hihoku/<span class="number">65</span>.hihoku.com;
          index  index.php index.html index.htm;
          try_files <span class="variable">$uri</span> <span class="variable">$uri</span>/ /index.php;  
        }
 
 
        error_page   <span class="number">500</span> <span class="number">502</span> <span class="number">503</span> <span class="number">504</span>  /<span class="number">50</span>x.html;
        location = /<span class="number">50</span>x.html {
            root   html;
        }
        location ~ \.php$ {
            root   F:/kuaipan/hihoku/<span class="number">65</span>.hihoku.com;
            fastcgi_pass localhost:<span class="number">9000</span>;
            fastcgi_index index.php;
            include fastcgi_params;
            fastcgi_param XGEN <span class="variable">$generater</span>;
            fastcgi_param SCRIPT_FILENAME <span class="variable">$document_root</span><span class="variable">$fastcgi_script_name</span>;
        }
 
 
    }
<span class="comment">#server 65.hihoku.com end}</span>
</pre></td></tr></table></figure><br>在web根目录下<code>F:/kuaipan/hihoku/65.hihoku.com</code>，新建<code>index.php</code>,写入内容：<br><figure class="highlight php"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre><span class="preprocessor">&lt;?php</span> phpinfo();<span class="preprocessor">?&gt;</span>
</pre></td></tr></table></figure>

<p><code>nginx -t</code> 测试没有问题后 重启nginx</p>
<h3 id="Step2:_@win7_开发机设置_ssh_forward">Step2: <code>@win7</code> 开发机设置 <code>ssh forward</code></h3>
<p>可以使用<code>putty</code>，或者<code>cygwin</code>、<code>minGW</code>里的ssh命令，我机器上有<code>minGW</code>，执行<code>ssh -v</code>查看。</p>
<ul>
<li>使用密钥 登陆 :   <code>@ win7</code></li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>f:\&gt;ssh root@cpp65 -i C:\Users\Administrator\ .ssh\id_rsa_cpp
</pre></td></tr></table></figure>

<p>登录成功，密钥可用 。</p>
<p>进行 <code>ssh forward</code> <code>@win7</code> :</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>C:\&gt;ssh -C -N -g -R <span class="number">7002</span>:localhost:<span class="number">80</span> root@cpp65 -i C:\Users\Admini strator\.ssh\id_rsa_cpp
</pre></td></tr></table></figure>

<p>这是整个过程中最不好理解的一个步骤，实际上可以看作一个变相的端口映射过程，即将本地的80端口通过ssh映射到远程<code>cpp65</code>的7002端口。这里的<code>localhost</code>指是<code>cpp65</code>而不是本地的<code>win7</code>，也可以修改为其他机器，比如<code>cpp66</code>之类的，只要<code>cpp65</code>能访问到。具体参数参考文章后面的附录</p>
<blockquote>
<p>注意，此命令成功后<strong>没有任何提示</strong>。在<code>@cpp65</code>查看监听端口，可以看到<code>7002</code>端口正在监听。</p>
</blockquote>
<pre><code><span class="comment"># netstat -tlnp | grep :7002</span>
tcp        <span class="number">0</span>      <span class="number">0</span> <span class="number">127.0</span>.<span class="number">0</span>.<span class="number">1</span><span class="symbol">:</span><span class="number">7002</span>              <span class="number">0</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">0</span><span class="symbol">:*</span>                   <span class="constant">LISTEN</span>      <span class="number">9016</span>/sshd
tcp        <span class="number">0</span>      <span class="number">0</span> <span class="symbol">:</span><span class="symbol">:</span><span class="number">1</span><span class="symbol">:</span><span class="number">7002</span>                    <span class="symbol">:</span><span class="symbol">:</span><span class="symbol">:*</span>                        <span class="constant">LISTEN</span>      <span class="number">9016</span>/sshd
</code></pre><p>如果<code>forward</code>失败，提示如下，请检查主机名和登录凭据。</p>
<blockquote>
<p>Warning: remote port forwarding failed for listen port 7002</p>
</blockquote>
<p>也可使用<code>putty</code> 连接，设置如下：</p>
<p><img src="/image/puttys2c.jpg" alt="putty的通道设置"></p>
<h3 id="Step3:_@cpp65_nginx配置反向代理:">Step3: <code>@cpp65</code> nginx配置反向代理:</h3>
<p>最简单的配置如下：</p>
<p><figure class="highlight bash"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="code"><pre>server{
       	listen  <span class="number">80</span>;
        server_name <span class="number">65</span>.hihoku.com;
        access_log /hihoku/log/web/<span class="number">65</span>.access.log;


        location / {
                proxy_pass http://<span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">7002</span>;
                include proxy.conf;
        }


   	}
</pre></td></tr></table></figure><br><code>@cpp65</code> 重启nginx,  此时再访问 <a href="http://65.hihoku.com" target="_blank">http://65.hihoku.com</a>   可以看到开发机的虚拟服务器了。<br> <img src="/image/phpinfo.jpg" alt="本机的phpinfo"></p>
<blockquote>
<p>注意:  由于开发机配置了多个虚拟服务器， 如果<code>@cpp65</code>上直接 访问<a href="http://127.0.0.1:7002" target="_blank">http://127.0.0.1:7002</a>  可以看到开发机本地按 <a href="http://localhost" target="_blank">http://localhost</a>   访问的结果,而非<code>65.hihoku.com</code>。</p>
</blockquote>
<h3 id="Step4:_验证和接入">Step4: 验证和接入</h3>
<p>登录<a href="https://mp.weixin.qq.com/" target="_blank">微信公众帐号平台</a>,进入<code>开发模式</code>。</p>
<p>参考：<a href="http://mp.weixin.qq.com/wiki/index.php?title=%E6%8E%A5%E5%85%A5%E6%8C%87%E5%8D%97" target="_blank">接入指南 - 微信公众平台开发者文档</a></p>
<p>下载php示例并解压，将php文件改名为<code>wx.php</code>并放在开发机配置的web根目录下,本机为<code>F:/kuaipan/hihoku/65.hihoku.com</code><br>将<code>wx.php</code>的<code>define(&quot;TOKEN&quot;, &quot;weixin&quot;);</code>改为你自己的token。</p>
<p>填写接口配置：<br><img src="http://mp.weixin.qq.com/wiki/images/4/41/%E6%8E%A5%E5%8F%A3%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF.png" alt=""></p>
<blockquote>
<p>token为你自己在<code>wx.php</code>中定义的 token<br>url为<a href="http://65.hihoku.com/wx.php" target="_blank">http://65.hihoku.com/wx.php</a>,提交即可。</p>
</blockquote>
<h3 id="Step5:_@win7_设置robots协议,_禁止蜘蛛抓取开发机域名下的内容">Step5: <code>@win7</code> 设置robots协议, 禁止蜘蛛抓取开发机域名下的内容</h3>
<p>这是额外的步骤，防止因测试环境与生产环境内容重复破坏主站的SEO </p>
<p>nginx虚拟服务器配置加入以下内容：</p>
<pre><code><span class="keyword">if</span> (<span class="variable">$host</span> ~ <span class="string">'^65.hihoku.com'</span>){
    rewrite ^<span class="regexp">/robots.txt$ /robots</span>_deny.txt last;
}
</code></pre><p>根目录新建以下文件：<code>robots_deny.txt</code>，写入内容：</p>
<pre><code> <span class="constant">User</span>-<span class="symbol">agent:</span>*
 <span class="constant">Disallow</span><span class="symbol">:/</span>
</code></pre><p>重启nginx生效</p>
<h4 id="ssh_forward_相关参数的解释：">ssh forward 相关参数的解释：</h4>
<blockquote>
<p> -f Fork into background after authentication.<br>后台认证用户/密码，通常和-N连用，不用登录到远程主机。<br>-L port:host:hostport<br>将 本地机(客户机)的某个端口转发到远端指定机器的指定端口. 工作原理是这样的, 本地机器上分配了一个 socket 侦听 port 端口, 一旦这 个端口上有了连接, 该连接就经过安全通道转发出去, 同时远程主机和 host 的 hostport 端口建立连接. 可以在配置文件中指定端口的转 发. 只有 root 才能转发特权端口. IPv6 地址用另一种格式说明: port/host/hostport<br>-R port:host:hostport<br>将 远程主机(服务器)的某个端口转发到本地端指定机器的指定端口. 工作原理是这样的, 远程主机上分配了一个 socket 侦听 port 端口, 一 旦这个端口上有了连接, 该连接就经过安全通道转向出去, 同时本地主机和 host 的 hostport 端口建立连接. 可以在配置文件中指定端口 的转发. 只有用 root 登录远程主机才能转发特权端口. IPv6 地址用另一种格式说明: port/host/hostport<br>-D port<br>指 定一个本地机器 “动态的’’ 应用程序端口转发. 工作原理是这样的, 本地机器上分配了一个 socket 侦听 port 端口, 一旦这个端口上 有了连接, 该连接就经过安全通道转发出去, 根据应用程序的协议可以判断出远程主机将和哪里连接. 目前支持 SOCKS4 协议, 将充 当 SOCKS4 服务器. 只有 root 才能转发特权端口. 可以在配置文件中指定动态端口的转发.<br>-C Enable compression.<br>压缩数据传输。<br>-N Do not execute a shell or command.<br>不执行脚本或命令，通常与-f连用。<br>-g Allow remote hosts to connect to forwarded ports.<br>在-L/-R/-D参数中，允许远程主机连接到建立的转发的端口，如果不加这个参数，只允许本地主机建立连接。注：这个参数我在实践中似乎始终不起作用。</p>
</blockquote>
<h4 id="参考_:">参考 :</h4>
<ul>
<li><a href="http://hi.baidu.com/oldsvn/item/c7940804f216f41d6c9048da" target="_blank">SSH隧道与端口转发及内网穿透<em>oldsvn’ Blog</em>百度空间</a></li>
</ul>
<ul>
<li><p><a href="http://falcon.sinaapp.com/post-34900.html" target="_blank">实战SSH Forward、ssh-copy-id、autossh及其他 | 雕刻时光</a></p>
</li>
<li><p><a href="http://mp.weixin.qq.com/wiki/index.php?title=%E6%8E%A5%E5%85%A5%E6%8C%87%E5%8D%97" target="_blank">接入指南 - 微信公众平台开发者文档</a></p>
</li>
</ul>
]]></content>
    <summary type="html"><![CDATA[<p>概况：</p>
<ul>
<li><p>本地开发机 <code>win7</code> ,计算机名：<code>FALCON-PC</code> ,公司内网无法进行80端口映射.已安装 <code>nginx+php+mysql</code></p>
</li>
<li><p>外网测试机环境为<code>centos6.4</code>，主机名<code>cpp65</code> 。已安装<code>nginx</code></p>
</li>
<li><p>使用域名 <code>65.hihoku.com</code> 进行开发测试，A记录已指向<code>cpp65</code></p>
</li>
</ul>
<p>搭建目标：</p>
<ul>
<li>微信服务器能直接与本地开发机通讯，本地开发即时看到调试效果</li>
</ul>
<p>原理和实现：</p>
<ul>
<li><p>由于微信服务器不能直接访问内网的开发机，所以先让微信服务器访问外网测试主机，测试主机通过ssh隧道将请求转发至开发机，取得开发机响应的数据后，再返回给微信服务器。</p>
</li>
<li><p>SSH Forward 远程端口转发（<code>S2C</code>模式）+ <code>nginx反向代理</code> </p>
</li>
</ul>
]]></summary>
    
      <category term="微信" scheme="http://falconchen.github.io/tags/%E5%BE%AE%E4%BF%A1/"/>
    
      <category term="ssh" scheme="http://falconchen.github.io/tags/ssh/"/>
    
      <category term="nginx" scheme="http://falconchen.github.io/tags/nginx/"/>
    
      <category term="反向代理" scheme="http://falconchen.github.io/tags/%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86/"/>
    
      <category term="微信开发" scheme="http://falconchen.github.io/categories/%E5%BE%AE%E4%BF%A1%E5%BC%80%E5%8F%91/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[我不是为了输赢，我就是认真。]]></title>
    <link href="http://falconchen.github.io/2014/05/26/luo/"/>
    <id>http://falconchen.github.io/2014/05/26/luo/</id>
    <published>2014-05-26T07:06:04.000Z</published>
    <updated>2014-05-28T02:16:30.000Z</updated>
    <content type="html"><![CDATA[<blockquote>本文转自CoolShell.cn 作者：陈皓，原文链接：<a href="http://coolshell.cn/articles/11629.html" title="我只是认真」聊聊工匠情怀 " target="_blank">「我只是认真」聊聊工匠情怀 | 酷 壳 - CoolShell.cn</a></br></blockquote>
<p>老罗的Smartisan T1手机发布会很多人应该都看了，发布会的最后老罗凝视着自己的工匠自画像，半晌没说话，随后转过身，慢慢离开舞台，屏幕下方只留下一句话：</p>
<p style="padding-left: 30px;"><strong>我不是为了输赢，我就是认真。</strong></p>
<p>这一瞬间让我想起93年「狮城舌战」的主角蒋昌建，在「人性本善还是人性本恶」的总结陈词最后，以顾城的名句，「黑夜给了我黑色的眼睛，我却用它寻找光明」，把整个辩论赛的氛围推向高潮。</p>
<p>而老罗的这句话，和这句话背后的工匠背景，却以另外一种<span style="color: #ff0000;"><strong>无声的却震人心魄的力量</strong></span>，敲打着每一个在场的，或是观看着整个发布会的观众的心绪。</p>
<p>「工匠情怀」，我深有体会，就像我在 <a href="http://blog.hesey.net/2014/05/gc-oriented-java-programming.html" target="_blank">面向GC的Java编程</a> 一文中所提到的：</p>
<p style="padding-left: 30px;"><span style="color: #ff6600;"><strong>优秀程序员的价值，不在于其所掌握的几招屠龙之术，而是在细节中见真著。</strong></span></p>
<p style="padding-left: 30px;"><span style="color: #ff6600;"><strong>如果我们可以一次把事情做对，并且做好，在允许的范围内尽可能追求卓越，为什么不去做呢？</strong></span></p>
<a id="more"></a>
<p>追求卓越，追求完美，追求细节的极致。小时候看到那些修表匠，握着一个小螺丝刀，或是看着电工，用烙铁沾着锡和松香，在那一小寸的世界里，把坏了的地方修好，那种专注的眼神，觉得很厉害。</p>

<p>现在再去回想那些工匠工作的场景，越发觉得钦佩。在我老家有一家刻章的店，在我上幼儿园的时候就已经在那开了很多年了。前段时间需要刻一个章，发现那家店还在，于是走进去，门口坐着一个老人，我确实记不得当年是不是他，不过看这岁数八九不离十。我以前在别的地方刻的章，都是在电脑里设计完图案后，激光刻蚀。但那次老人却是用的手刻，我着实惊呆了。只看他拿出一块红色的印底，右手持着刻刀，开始一下一下地刻着。虽然老人连话都不怎么说得清了，但是工作时那专注的神情，和精湛的手艺，以及最后成品那比机器更完美的效果，着实让我心里非常动容。</p>
<p><span id="more-11629"></span></p>
<h4>一、技术人的执着</h4>
<p>我见过很多人，也见过很多程序员，都有如此的「工匠情怀」。</p>
<p>做产品需求评审，有的人善于快速提供技术解决方案，在最短的时间内解决问题。</p>
<p>但我见过的很多牛人，他们除了能在脑海里最快地形成方案原型，并且更深入地考虑各种细节点，最终能给出一个更趋于完善的技术方案。</p>
<p>在他们身上，我看到了<span style="color: #ff0000;"><strong>对这项职业的自我尊重，对自我价值的追求，也有对「卓越」的理解和渴求</strong></span>。</p>
<p>《精通正则表达式》的译者余晟老师写过他和正则表达式的 <a href="http://www.luanxiang.org/blog/archives/1717.html" target="_blank">缘起</a> 。只是因为项目经理让他「多用Google，查查正则表达式的资料」，余老师打开了正则的大门，读完了英文原版的《Mastering Regular Expression》，如今成为了国内最了解正则表达式的人之一。</p>
<p>看完那篇文章其实我想起了我的实习经历。那时候我刚去公司两三天，有一天我老板找我让我研究一下如何用Java里的MappedByteBuffer做文件内存映射来读取大文件。尽管我们当时要处理的文件很大，以我在学校编码的经验看，用普通的Reader也是可以很好地解决的。</p>
<p>于是我说，「这个其实用Reader也能做，更简单一些，没那么麻烦。」</p>
<p>老板反问我，「什么叫没那么麻烦，这是一个做技术的人的态度吗？」</p>
<p>那几天我花了很多时间，去从Linux一直到JVM，去了解什么是内存映射，底层原理是什么，和其它技术的比较、优缺点，并和其它几种读文件的技术做了性能对比。</p>
<p>虽然最后项目没有采用这个方案，但是那句反问直到现在一直在我脑海里，时时地提醒我：「<span style="color: #ff0000;"><strong>做技术的人，对待技术，应该拥有什么样的态度？</strong></span>」</p>
<p>所以其实我很感谢我的老板，以前他教我们这些新人优秀的职场习惯，有一条是每天的邮件必须没有未读数，即便是不需要阅读的邮件，也要一键置为已读，不要留一个未读的数字在那。现在想起来，有点像iOS App右上角那个提醒数的角标，有些强迫症的人怎么也忍受不了有个红圈圈在那。开个玩笑，虽然有些习惯看起来可有可无，无关紧要，但这确实映射了一种态度和思维习惯。</p>
<p><span style="color: #ff0000;"><strong>完美有多远？我不知道，但我愿意多往前走一步。</strong></span></p>
<h4>二、拾起初衷</h4>
<p>我们的生活，每天很忙碌。有时候忙得自己都忘记了为什么在此处，有时候忙得只能不断地用直觉、用以往的经验去设计一个解决方案，而没有时间去思考需求是不是合理，方案是不是最佳，我们以为自己设计的是最佳实践，谁知道呢？</p>
<p>这个社会，这个世界，处在一个以不可思议的速度向前直奔的时间线上，我们处在这个时代的浪潮之上，每个人都感到了那种令人窒息的紧迫感。</p>
<p>父母都是不希望孩子太累的，我们见过很多这样的话：</p>
<p style="padding-left: 30px;"><span style="color: #ff6600;"><strong>差不多就行了。</strong></span></p>
<p style="padding-left: 30px;"><span style="color: #ff6600;"><strong>糊弄糊弄就完事了。</strong></span></p>
<p style="padding-left: 30px;"><span style="color: #ff6600;"><strong>不要与众不同。</strong></span></p>
<p style="padding-left: 30px;"><span style="color: #ff6600;"><strong>顺其自然。</strong></span></p>
<p>但是你应该问问自己，是不是真的要 <a href="http://blog.hesey.net/2010/05/is-let-it-be-consolation-or-excuse.html" target="_blank">顺其自然</a> ？</p>
<p>我记得在上大二的时候，听一个叫端木恒的人说过一句话，大意是，<span style="color: #ff0000;"><strong>这个世界上，政治可以改变很多事情，而科技，可以通过促进信息的流通，最终去推动政治的变革，去改变整个世界。</strong></span></p>
<p>当时觉得这事儿太酷了，是的，所以我当时的想法是，要去一个技术足够强大，并且对人们的生活有实质影响的公司。希望用技术的力量去让更多人生活地更好。</p>
<p>这当然是一种不自量力，但又如何呢？只是一个普通人小小的想法，不断追求卓越，愿意比别人多往前走一步而已。</p>
<p>就像冯大辉说的：</p>
<p><span style="color: #ff6600;"><strong>所有人都说你做不成，都告诉你不要去做，不靠谱，嘲讽你，而你最后真的把事情做起来了，这就是牛逼。</strong></span></p>
<p>做成了，其实牛不牛逼对你自己而言已经不重要了。</p>
<p>没做成，所有人都笑你是傻逼，但起码也对得起自己的内心。</p>
<p>再说，如果 <a href="http://blog.hesey.net/2010/05/strength-of-the-young.html" target="_blank">青年人</a> 想的都是养老和退休，那做事的人在哪？</p>
<h4>三、发现更好的自己</h4>
<p>老罗最后的一个问题是：</p>
<p style="padding-left: 30px;"><span style="color: #ff6600;"><strong>在一个完美主义者的眼里，这是一个怎样的世界？</strong></span></p>
<p>这个社会上很多人在生活上追求更高的品质，但愿意对自己手头所做的事情坚持高标准坚持卓越理念的人已经不多见了，以至于我们发现<span style="color: #ff0000;"><strong>花再多的钱也买不到安全的食品了，花了一辈子的积蓄买的房子却有各种质量问题</strong></span>。扪心自问自己在工作中是否能坚持某些东西，大部分人的态度都差不多，只是你糊弄一下不会怎样，而他马虎一点就会死人，<span style="color: #ff0000;"><strong>区别仅仅在于这里</strong></span>。</p>
<p>M·斯科特·派克说过一句话：</p>
<p style="padding-left: 30px;"><span style="color: #ff6600;"><strong>规避问题和逃避问题的趋向，是人类心理疾病的根源。</strong></span></p>
<p>很多人把随大流把妥协作为一种「成熟」的标志，小时候敢想敢说可能也敢做，长大以后懂得了人情世故，懂得向现实妥协，45度角仰望天空说自己终于长大了。再看身边那些「冥顽不灵」、「认死理」的所谓完美主义者，认为这些人才是不正常的群体，把这些人要么当做傻逼要么当做装逼。</p>
<p>天哪，我都想问，「这是一个怎样的世界？」</p>
<p>肯定有人会说，站着说话不腰疼。诚然，在生活中，有的人是为了活下去，有的人是为了活得更好，有的人是为了帮助别人活得更好。这是不同的人生阶段，每个人的情况不一样，但这并不影响每个人内心的精神寄托和对信念的追求。</p>
<p>我从不指望去改变别人，但我相信我可以改变自己，虽然也很难。</p>
<p>学生都喜欢问，如何最快地告诉自己的能力。说实话，我真的不知道什么是捷径，我的经验就是和比你优秀的人一起工作，经常请教比你资深的人，不断挑战过去的自己（每天审视自己太紧张了，只要比前段时间的自己更好就可以了）。</p>
<h4>四、细节是魔鬼</h4>
<p>Devils are in the details，细节是魔鬼，这句话很多人都听过，但要在工作中时时刻刻注意？难。</p>
<p>前几天给同事做Code Review，就几行代码，发现了一个问题。</p>
<p style="padding-left: 30px;">场景是我们发现某个系统中存在占用内存超大的HTML字符串，需要统计HTML字符串的长度，于是为了获得准确的字节长度，这段代码调用的是String.getBytes().length，一眼看起来并没有什么大问题。</p>
<p style="padding-left: 30px;">但是考虑到本身这个字符串就比较大，联想到Java内部是用UTF-16存储字符串的，而getBytes()会转换为系统默认编码（GBK或是UTF-8等等），这里必然存在底层字符数组的拷贝（可以去参考String.getBytes()的源代码证实），一个本身就很大的字符串，经过拷贝，将会占用更多的内存，加剧这个问题，而在HTML中，中文其实只占了非常小的一部分，所以直接用String.length()，虽然会少数几个字符，但对统计结果影响其实并不大，并且这里不存在任何数组分配的开销。</p>
<p style="padding-left: 30px;">另外建议所有调用String.getBytes()的地方通通显式传入编码，这是个大坑。</p>
<p>另外一个案例，也是在Code Review的时候发现的。</p>
<p style="padding-left: 30px;">某个调用场景下，每次都会新建一个解析器对象去解析结果，尽管解析器没有任何实例变量不会产生线程安全问题，创建的开销也并不大，但我还是坚持要改成单例，使用同一个实例去处理，这也符合面向GC编程的思想。</p>
<p style="padding-left: 30px;">这些场景，每天我们都在遇到，<span style="color: #ff0000;"><strong>也许我们会说这些都是很小的问题，无伤大雅，差不多就行了</strong></span>。但就像前面说的，这是一种态度，一种思维习惯，当你坚持用最高的标准去要求自己，去要求自己的工作时，你才有可能渐渐接近卓越。细节是魔鬼，它会在完全察觉不到的时刻，把人拉回平庸。</p>
<p>「我不是为了输赢，我就是认真。」这不代表我们不在乎输赢，从头至尾我都坚信，只有坚持完美，坚持品质，坚持那些我们曾经了解现在可能已经放弃了的美好的东西，像一个老工匠，把一种专注、追求极致的情怀融入我们的作品里，也许有一天，就有人，追寻着 <a href="http://blog.hesey.net/2010/04/a-time-without-dreams.html" target="_blank">梦想</a> ，发现了 <a href="http://blog.hesey.net/2012/02/posibilities-of-life.html" target="_blank">生活更多的可能性</a> ，像乔布斯、像贝索斯，改变整个行业，改变全世界。</p>
<p>我们是被这个时代推上浪潮之巅的人，是去做一个见证者，或是一个冲在最前面也不怕被拍死的傻瓜，是我们每个人选择的权利。</p>
<p>只是不要忘记，那些傻瓜，不是真的不怕死，<span style="color: #ff0000;"><strong>他们只是认真</strong></span>。</p>
]]></content>
    <summary type="html"><![CDATA[<blockquote>本文转自CoolShell.cn 作者：陈皓，原文链接：<a href="http://coolshell.cn/articles/11629.html" title="我只是认真」聊聊工匠情怀 " target="_blank">「我只是认真」聊聊工匠情怀 | 酷 壳 - CoolShell.cn</a></br></blockquote>
<p>老罗的Smartisan T1手机发布会很多人应该都看了，发布会的最后老罗凝视着自己的工匠自画像，半晌没说话，随后转过身，慢慢离开舞台，屏幕下方只留下一句话：</p>
<p style="padding-left: 30px;"><strong>我不是为了输赢，我就是认真。</strong></p>
<p>这一瞬间让我想起93年「狮城舌战」的主角蒋昌建，在「人性本善还是人性本恶」的总结陈词最后，以顾城的名句，「黑夜给了我黑色的眼睛，我却用它寻找光明」，把整个辩论赛的氛围推向高潮。</p>
<p>而老罗的这句话，和这句话背后的工匠背景，却以另外一种<span style="color: #ff0000;"><strong>无声的却震人心魄的力量</strong></span>，敲打着每一个在场的，或是观看着整个发布会的观众的心绪。</p>
<p>「工匠情怀」，我深有体会，就像我在 <a href="http://blog.hesey.net/2014/05/gc-oriented-java-programming.html" target="_blank">面向GC的Java编程</a> 一文中所提到的：</p>
<p style="padding-left: 30px;"><span style="color: #ff6600;"><strong>优秀程序员的价值，不在于其所掌握的几招屠龙之术，而是在细节中见真著。</strong></span></p>
<p style="padding-left: 30px;"><span style="color: #ff6600;"><strong>如果我们可以一次把事情做对，并且做好，在允许的范围内尽可能追求卓越，为什么不去做呢？</strong></span></p>
]]></summary>
    
      <category term="罗永浩" scheme="http://falconchen.github.io/tags/%E7%BD%97%E6%B0%B8%E6%B5%A9/"/>
    
      <category term="工匠情怀" scheme="http://falconchen.github.io/tags/%E5%B7%A5%E5%8C%A0%E6%83%85%E6%80%80/"/>
    
      <category term="业界" scheme="http://falconchen.github.io/tags/%E4%B8%9A%E7%95%8C/"/>
    
      <category term="转载" scheme="http://falconchen.github.io/categories/%E8%BD%AC%E8%BD%BD/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[hexo安装插件]]></title>
    <link href="http://falconchen.github.io/2014/05/26/hexo%E5%AE%89%E8%A3%85%E6%8F%92%E4%BB%B6/"/>
    <id>http://falconchen.github.io/2014/05/26/hexo安装插件/</id>
    <published>2014-05-26T02:06:04.000Z</published>
    <updated>2014-05-26T02:43:59.000Z</updated>
    <content type="html"><![CDATA[<p>安装插件：</p>
<p><figure class="highlight bash"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>npm install &lt;plugin-name&gt; --save
</pre></td></tr></table></figure><br>启用插件：在<code>hexo\_config.yml</code>文件添加：</p>
<pre><code>plugins:
-<span class="ruby"> &lt;plugin-name&gt;  <span class="comment">#插件名</span></span>
</code></pre><p>升级插件：</p>
<p><figure class="highlight bash"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>npm update
</pre></td></tr></table></figure><br>卸载插件：</p>
<p><figure class="highlight bash"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>npm uninstall &lt;plugin-name&gt;
</pre></td></tr></table></figure><br>RSS插件<br>将上述命令中的『plugin-name』，替换为<code>hexo-generator-feed</code>。一旦安装完成，你可以在配置显示你站点的RSS，文件路径<code>/atom.xml</code>。</p>
<p>你可以用rss作为迁移工具，用如下命令读取其他位置的rss：</p>
<p><figure class="highlight bash"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>hexo migrate rss &lt;<span class="built_in">source</span>&gt;
</pre></td></tr></table></figure><br>修改主题<code>header.ejs</code>，加入:</p>
<pre><code><span class="tag">&lt;<span class="title">li</span>&gt;</span><span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"/atom.xml"</span> <span class="attribute">title</span>=<span class="value">"rss feed"</span>&gt;</span>Rss<span class="tag">&lt;/<span class="title">a</span>&gt;</span><span class="tag">&lt;/<span class="title">li</span>&gt;</span>
</code></pre>]]></content>
    
    
      <category term="nodejs" scheme="http://falconchen.github.io/tags/nodejs/"/>
    
      <category term="hexo" scheme="http://falconchen.github.io/tags/hexo/"/>
    
      <category term="npm" scheme="http://falconchen.github.io/tags/npm/"/>
    
      <category term="nodejs" scheme="http://falconchen.github.io/categories/nodejs/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[hexo命令及用法]]></title>
    <link href="http://falconchen.github.io/2014/05/26/hexo%E5%91%BD%E4%BB%A4%E5%8F%8A%E7%94%A8%E6%B3%95/"/>
    <id>http://falconchen.github.io/2014/05/26/hexo命令及用法/</id>
    <published>2014-05-26T01:47:53.000Z</published>
    <updated>2014-05-28T04:21:01.000Z</updated>
    <content type="html"><![CDATA[<p>安装和本地预览：</p>
<pre><code>npm <span class="keyword">install</span> hexo -g <span class="comment">#全局安装hexo模块，安装缓慢或出错请看上文</span>
hexo init blog <span class="comment">#初始化本地目录，也可cd到指定目录直接执行 hexo init</span>
cd blog
npm <span class="keyword">install</span> <span class="comment">#不要忘记执行此命令，否则生成html会不正常</span>
hexo server <span class="comment">#默认使用http://localhost:4000/，可在_config.yml更改</span>
</code></pre><p>撰写文章：</p>
<pre><code>hexo <span class="keyword">new</span> [模板名] 文章名称 <span class="preprocessor">#使用指定模板创建文章</span>
hexo <span class="keyword">new</span> page <span class="string">"pageName"</span> <span class="preprocessor">#新建页面</span>
hexo generate            <span class="preprocessor">#生成html，需要在init的目录执行</span>
hexo deploy              <span class="preprocessor">#部署到github、heroku</span>
</code></pre><p>命令缩写（精简为命令的首字母）:</p>
<pre><code>hexo n
hexo g
hexo s
hexo d
</code></pre>]]></content>
    
    
      <category term="nodejs" scheme="http://falconchen.github.io/tags/nodejs/"/>
    
      <category term="hexo" scheme="http://falconchen.github.io/tags/hexo/"/>
    
      <category term="nodejs" scheme="http://falconchen.github.io/categories/nodejs/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[hexo创建404]]></title>
    <link href="http://falconchen.github.io/2014/05/23/hexo%E5%88%9B%E5%BB%BA404/"/>
    <id>http://falconchen.github.io/2014/05/23/hexo创建404/</id>
    <published>2014-05-23T10:01:01.000Z</published>
    <updated>2014-05-26T01:50:49.000Z</updated>
    <content type="html"><![CDATA[<p>先做好一个<code>404.html</code>的html页面，放到<code>source</code>文件夹下，此时如果进行生成，hexo会自作多情地render，要禁止解析，可以在html内容前加入：</p>
<p><figure class="highlight markdown"><table><tr><td class="gutter"><pre>1
2
</pre></td><td class="code"><pre><span class="header">layout: false
---</span>
</pre></td></tr></table></figure><br>即可，此时生成会在public生成一个404.html页面，在<code>github</code>无须设置，在其他服务器(如<code>nginx</code>)还需要改动配置文件。</p>
<p>这是本站的<code>公益404页面</code>:<a href="http://falconchen.github.io/404.html" target="_blank">http://falconchen.github.io/404.html</a></p>
]]></content>
    
    
      <category term="nodejs" scheme="http://falconchen.github.io/tags/nodejs/"/>
    
      <category term="hexo" scheme="http://falconchen.github.io/tags/hexo/"/>
    
      <category term="404" scheme="http://falconchen.github.io/tags/404/"/>
    
      <category term="nodejs" scheme="http://falconchen.github.io/categories/nodejs/"/>
    
  </entry>
  
</feed>
